<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Tournament - Model comparison • bdrc</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tournament - Model comparison">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bdrc</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/background.html">Background</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/introduction.html">Introduction to bdrc</a></li>
    <li><a class="dropdown-item" href="../articles/tournament.html">Tournament - Model Comparison</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sor16/bdrc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Tournament - Model comparison</h1>
                        <h4 data-toc-skip class="author">Solvi
Rognvaldsson, Rafael Daniel Vias, Birgir Hrafnkelsson and Axel Orn
Jansson</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sor16/bdrc/blob/HEAD/vignettes/tournament.Rmd" class="external-link"><code>vignettes/tournament.Rmd</code></a></small>
      <div class="d-none name"><code>tournament.Rmd</code></div>
    </div>

    
    
<p>This vignette explores the ways you can compare the fit of the
different discharge rating curve models provided in the
<code>bdrc</code> package. The package includes four different models to
fit a discharge rating curve of different complexities. These are:</p>
<ul>
<li><p><code><a href="../reference/plm0.html">plm0()</a></code> - Power-law model with constant log-error
variance.</p></li>
<li><p><code><a href="../reference/plm.html">plm()</a></code> - Power-law model with stage-dependent
log-error variance.</p></li>
<li><p><code><a href="../reference/gplm0.html">gplm0()</a></code> - Generalized power-law model with constant
log-error variance.</p></li>
<li><p><code><a href="../reference/gplm.html">gplm()</a></code> - Generalized power-law model with
stage-dependent log-error variance.</p></li>
</ul>
<p>The ‘0’ indicates that the variance of the log-transformed errors is
modeled as a constant. The <code>plm0</code> model is simply a Bayesian
hierarchical implementation of the classical power-law model, widely
used in hydrological practice. For more details on these models, refer
to Hrafnkelsson et al. (2022). For an brief overview of the underlying
theory, see our <a href="background.html">Background</a> vignette. For
guidance on applying these models to your data, refer to the <a href="introduction.html">Introduction</a> vignette.</p>
<div class="section level2">
<h2 id="the-tournament-method">The tournament method<a class="anchor" aria-label="anchor" href="#the-tournament-method"></a>
</h2>
<p>The tournament method uses the Widely Applicable Information
Criterion (WAIC) (Watanabe, 2010) to select the most appropriate model
for a given dataset. The WAIC balances two factors:</p>
<ol style="list-style-type: decimal">
<li><p>Goodness-of-fit: How well the model fits the observed
data.</p></li>
<li><p>Model complexity: A penalty term accounting for the effective
number of parameters.</p></li>
</ol>
<p>A lower WAIC indicates a better balance between model fit and
complexity, making it the preferred model.</p>
<p>The tournament process occurs in two rounds:</p>
<ol style="list-style-type: decimal">
<li>
<p>First round:</p>
<ul>
<li><p><code>gplm</code> vs <code>gplm0</code></p></li>
<li><p><code>plm</code> vs <code>plm0</code> <br></p></li>
</ul>
</li>
<li>
<p>Final round:</p>
<ul>
<li>Winners of the first round face off</li>
</ul>
</li>
</ol>
<p>In each comparison, we calculate the WAIC difference of the less and
more complex model,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mtext mathvariant="normal">WAIC</mtext><mo>=</mo><msub><mtext mathvariant="normal">WAIC</mtext><mtext mathvariant="normal">less</mtext></msub><mo>−</mo><msub><mtext mathvariant="normal">WAIC</mtext><mtext mathvariant="normal">more</mtext></msub></mrow><annotation encoding="application/x-tex">\Delta\text{WAIC} = \text{WAIC}_{\text{less}} - \text{WAIC}_{\text{more}}</annotation></semantics></math>.
A positive
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mtext mathvariant="normal">WAIC</mtext></mrow><annotation encoding="application/x-tex">\Delta\text{WAIC}</annotation></semantics></math>
suggests the more complex model is more appropriate. However, to advance
to the next round,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mtext mathvariant="normal">WAIC</mtext></mrow><annotation encoding="application/x-tex">\Delta\text{WAIC}</annotation></semantics></math>
must exceed a pre-specified “winning criteria” (default value = 2). This
threshold helps ensure that we only choose a more complex model if it
offers a substantial improvement.</p>
<p>The default winning criteria of 2 is based on statistical guidelines
for model selection (Burnham &amp; Anderson, 2002), balancing the
trade-off between model fit and complexity. It helps prevent overfitting
by requiring evidence to justify a more complex model. In the following
sections, we’ll provide code examples demonstrating how to conduct the
power-law tournament with your own data using the <code>bdrc</code>
package.</p>
</div>
<div class="section level2">
<h2 id="introducing-the-tournament-function">Introducing the Tournament Function<a class="anchor" aria-label="anchor" href="#introducing-the-tournament-function"></a>
</h2>
<p>To demonstrate the tournament function, we’ll use a real-world
dataset from the Krokfors stream gauging station in Sweden, which is
included in the <code>bdrc</code> package:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(bdrc)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">data</span>(krokfors)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">head</span>(krokfors)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#&gt;          W          Q</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#&gt; 1 9.478000 10.8211700</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#&gt; 2 8.698000  1.5010000</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co">#&gt; 3 9.009000  3.3190000</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co">#&gt; 4 8.097000  0.1595700</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co">#&gt; 5 9.104000  4.5462500</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co">#&gt; 6 8.133774  0.2121178</span></span></code></pre></div>
<p>The Krokfors dataset contains 27 observations of discharge
measurements from a stream gauging station. Each observation consists of
two variables:</p>
<ul>
<li><p><code>W</code>: Water level (stage) measured in meters above a
fixed reference point.</p></li>
<li><p><code>Q</code>: Discharge, measured in cubic meters per second
(m³/s).</p></li>
</ul>
<p>The Krokfors data is particularly suitable for demonstrating the
tournament function as it provides a real-world example of the type of
data typically used in discharge rating curve analysis. The dataset will
help illustrate how different models perform across the range of
observed water levels and discharges.</p>
</div>
<div class="section level2">
<h2 id="running-a-tournament">Running a tournament<a class="anchor" aria-label="anchor" href="#running-a-tournament"></a>
</h2>
<p>The tournament function is straightforward to use, requiring two main
arguments:</p>
<ul>
<li><p><code>formula</code>: Specifies the relationship between
discharge and water elevation (e.g., <code>Q ~ W</code>).</p></li>
<li><p><code>data</code>: A <code>data.frame</code> with column names
corresponding to the variables specified in the formula.</p></li>
</ul>
<p>It is very important that the discharge is represented in cubic
meters per second (m³/s) and the water elevation in meters (m).</p>
<p>Let’s run our first tournament:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">set.seed</span>(<span class="dv">1</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="sc">&gt;</span> t_obj <span class="ot">&lt;-</span> <span class="fu">tournament</span>(Q <span class="sc">~</span> W, krokfors, <span class="at">parallel =</span> <span class="cn">TRUE</span>, <span class="at">num_cores =</span> <span class="dv">2</span>) </span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt; Running tournament  [                                                ] 0%</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt; Progress:</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt; Initializing Metropolis MCMC algorithm...</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; Multiprocess sampling (4 chains in 2 jobs) ...</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt; MCMC sampling completed!</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt; Diagnostics:</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&gt; Acceptance rate: 25.33%.</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&gt; ✔ All chains have mixed well (Rhat &lt; 1.1).</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&gt; ✔ Effective sample sizes sufficient (eff_n_samples &gt; 400).</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&gt;  ✔  gplm finished   [============                                    ] 25%</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt; Progress:</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&gt; Initializing Metropolis MCMC algorithm...</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#&gt; Multiprocess sampling (4 chains in 2 jobs) ...</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co">#&gt; MCMC sampling completed!</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="co">#&gt; Diagnostics:</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="co">#&gt; Acceptance rate: 31.14%.</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="co">#&gt; ✔ All chains have mixed well (Rhat &lt; 1.1).</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="co">#&gt; ✔ Effective sample sizes sufficient (eff_n_samples &gt; 400).</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="co">#&gt;  ✔  gplm0 finished  [========================                        ] 50%</span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a><span class="co">#&gt; Progress:</span></span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a><span class="co">#&gt; Initializing Metropolis MCMC algorithm...</span></span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a><span class="co">#&gt; Multiprocess sampling (4 chains in 2 jobs) ...</span></span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a><span class="co">#&gt; MCMC sampling completed!</span></span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a><span class="co">#&gt; Diagnostics:</span></span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a><span class="co">#&gt; Acceptance rate: 25.66%.</span></span>
<span id="cb2-39"><a href="#cb2-39" tabindex="-1"></a><span class="co">#&gt; ✔ All chains have mixed well (Rhat &lt; 1.1).</span></span>
<span id="cb2-40"><a href="#cb2-40" tabindex="-1"></a><span class="co">#&gt; ✔ Effective sample sizes sufficient (eff_n_samples &gt; 400).</span></span>
<span id="cb2-41"><a href="#cb2-41" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-42"><a href="#cb2-42" tabindex="-1"></a><span class="co">#&gt;  ✔  plm finished    [====================================            ] 75%</span></span>
<span id="cb2-43"><a href="#cb2-43" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-44"><a href="#cb2-44" tabindex="-1"></a><span class="co">#&gt; Progress:</span></span>
<span id="cb2-45"><a href="#cb2-45" tabindex="-1"></a><span class="co">#&gt; Initializing Metropolis MCMC algorithm...</span></span>
<span id="cb2-46"><a href="#cb2-46" tabindex="-1"></a><span class="co">#&gt; Multiprocess sampling (4 chains in 2 jobs) ...</span></span>
<span id="cb2-47"><a href="#cb2-47" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-48"><a href="#cb2-48" tabindex="-1"></a><span class="co">#&gt; MCMC sampling completed!</span></span>
<span id="cb2-49"><a href="#cb2-49" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-50"><a href="#cb2-50" tabindex="-1"></a><span class="co">#&gt; Diagnostics:</span></span>
<span id="cb2-51"><a href="#cb2-51" tabindex="-1"></a><span class="co">#&gt; Acceptance rate: 36.04%.</span></span>
<span id="cb2-52"><a href="#cb2-52" tabindex="-1"></a><span class="co">#&gt; ✔ All chains have mixed well (Rhat &lt; 1.1).</span></span>
<span id="cb2-53"><a href="#cb2-53" tabindex="-1"></a><span class="co">#&gt; ✔ Effective sample sizes sufficient (eff_n_samples &gt; 400).</span></span>
<span id="cb2-54"><a href="#cb2-54" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-55"><a href="#cb2-55" tabindex="-1"></a><span class="co">#&gt;  ✔  plm0 finished   [================================================] 100%</span></span></code></pre></div>
<p>This output provides valuable information about the MCMC sampling
process for each model:</p>
<ol style="list-style-type: decimal">
<li>Progress:<br><br><ul>
<li>Shows the overall progress of the tournament as each of the four
models is fitted sequentially.</li>
<li>Indicates the start of the Markov Chain Monte Carlo (MCMC) process
for each model.</li>
<li>Provides information on how the sampling process is being
distributed across your computer’s CPU cores. In this example, we see
that the 4 chain sampling process is being distributed across 2 CPU
cores (4 chains in 2 jobs).<br><br>
</li>
</ul>
</li>
<li>Diagnostics:<br><br><ul>
<li>Acceptance rate: The proportion of proposed parameter values that
were accepted in the MCMC sampling scheme.</li>
<li>Chain mixing: A message reporting if the different MCMC chains have
mixed well.</li>
<li>Effective sample size: A message reporting if enough independent
samples have been drawn from the posterior distribution.</li>
</ul>
</li>
</ol>
<p>If some parameters do not meet the criteria for chain mixing or
effective sample size (Gelman-rubin statistic (<code>Rhat</code>) &lt;
1.1 for mixing and effective number of samples
(<code>eff_n_samples</code>) &gt; 400 for sample size), the function
will print out a warning. This helps you identify potential issues with
the MCMC sampling for specific parameters.</p>
<p>These diagnostics help ensure the reliability of our results. Good
chain mixing and sufficient effective sample sizes indicate that our
MCMC sampling has likely converged to the true posterior distribution.
The function can be made to run silently by setting
<code>verbose = FALSE</code>.</p>
<p>Note: By default, <code>parallel=TRUE</code> and the function
automatically detects the number of available cores. Parallel processing
is used to run multiple MCMC chains simultaneously, significantly
reducing computation time for complex models or large datasets.</p>
<p>To see the tournament winner:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="sc">&gt;</span> t_obj <span class="co"># or alternatively print(t_obj)</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt; Tournament winner: gplm0</span></span></code></pre></div>
<p>If you’ve already fitted the four models separately and stored in
objects (e.g., <code>plm0.fit</code>, <code>plm.fit</code>,
<code>gplm0.fit</code>, <code>gplm.fit</code>), you can run the
tournament more efficiently:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="sc">&gt;</span> t_obj <span class="ot">&lt;-</span> <span class="fu">tournament</span>(<span class="fu">list</span>(plm0.fit, plm.fit, gplm0.fit, gplm.fit))</span></code></pre></div>
<p>The tournament function creates a tournament object which
contains:</p>
<ul>
<li>
<p><code>summary</code>: A data frame with detailed information on
the results of the different comparisons in the power-law tournament.
The contents of this data frame depend on the method used
(<code>"WAIC"</code>, <code>"DIC"</code>, or <code>"PMP"</code>) and
include:</p>
<ul>
<li>
<p>Common columns for all methods:</p>
<ul>
<li>
<code>round</code>: Indicates the tournament round (1 or 2). Round 1
compares the generalized and classical power-law models separately
(<code>gplm</code> vs <code>gplm0</code> and <code>plm</code> vs
<code>plm0</code>), whereas Round 2 compares the winners from Round
1.</li>
<li>
<code>comparison</code>: A numeric identifier for each model
comparison (1, 2, or 3). There are two comparisons in Round 1 and one in
Round 2.</li>
<li>
<code>complexity</code>: Indicates whether a model is the “more” or
“less” complex model in a given comparison. The “less” complex model is
given the advantage defined by the <code>winning_criteria</code>.<br>
</li>
<li>
<code>model</code>: The model type (<code>plm0</code>,
<code>plm</code>, <code>gplm0</code>, or <code>gplm</code>).</li>
<li>
<code>winner</code>: A logical value
(<code>TRUE</code>/<code>FALSE</code>) indicating whether the model was
selected as the winner.</li>
</ul>
</li>
<li>
<p>Method-specific columns:</p>
<ul>
<li>
<p>For <code>WAIC</code> (Widely Applicable Information
Criterion):</p>
<ul>
<li>
<code>lppd</code>: Log-pointwise predictive density, measuring how
well the model predicts the observed data</li>
<li>
<code>eff_num_param</code>: Effective number of parameters,
estimating model complexity</li>
<li>
<code>WAIC</code>: The computed WAIC value, balancing model fit and
complexity</li>
<li>
<code>SE_WAIC</code>: Standard error of the WAIC estimate</li>
<li>
<code>Delta_WAIC</code>: Difference in WAIC between compared
models</li>
<li>
<code>SE_Delta_WAIC</code>: Standard error of the difference in
WAIC</li>
</ul>
</li>
<li>
<p>For <code>DIC</code> (Deviance Information Criterion):</p>
<ul>
<li>
<code>D_hat</code>: Minus two times the log-likelihood evaluated at
the median of the posterior samples</li>
<li>
<code>eff_num_param</code>: Effective number of parameters,
estimating model complexity</li>
<li>
<code>DIC</code>: The computed DIC value, balancing model fit and
complexity</li>
<li>
<code>Delta_DIC</code>: Difference in DIC between compared
models</li>
</ul>
</li>
<li>
<p>For <code>PMP</code> (Posterior Model Probability):</p>
<ul>
<li>
<code>log_marg_lik</code>: Logarithm of the marginal likelihood,
estimated using the harmonic-mean estimator</li>
<li>
<code>PMP</code>: Posterior model probability computed with Bayes
factor, indicating the probability of each model given the data</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><code>contestants</code>: A list containing all of the fitted
model objects compared in the tournament, <code>plm0</code>,
<code>plm</code>, <code>gplm0</code> and <code>gplm</code>.</p></li>
<li><p><code>winner</code>: The model object of the tournament winner,
representing the most appropriate model given the data.</p></li>
<li>
<p><code>info</code>: A list containing specific information about
the tournament:</p>
<ul>
<li>The overall winner</li>
<li>The method used for comparison (<code>"WAIC"</code>,
<code>"DIC"</code>, or <code>"PMP"</code>)</li>
<li>The winning criteria applied</li>
</ul>
</li>
</ul>
<p>This structure allows users to easily access both the final results
(winner) and the detailed process (summary) of the model comparison, as
well as the full model objects for further analysis if needed.</p>
<p>The method-specific columns provide insights into the model selection
process: * For WAIC, lower values indicate better models, with
Delta_WAIC showing the magnitude of difference between models. * For
DIC, like WAIC, lower values are preferred, with Delta_DIC showing the
difference between models. * For PMP, higher probabilities indicate
stronger evidence for a model, with values closer to 1 suggesting
stronger support.</p>
<p>These metrics help users understand not just which model was
selected, but also the strength of evidence for that selection and the
relative performance of all compared models.</p>
<p>For a more comprehensive summary of the tournament results:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(t_obj)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt; === Tournament Model Comparison Summary ===</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; Method: WAIC </span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; Winning Criteria: Delta_WAIC &gt; 2 </span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; Overall Winner: gplm0 </span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; Comparison 1 Results:</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------------------------------- </span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt; complexity   model  winner lppd     eff_num_param  WAIC       SE_WAIC    Delta_WAIC SE_Delta_WAIC</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; more         gplm          20.7794  6.8706         -27.8176   11.8918    0.5570     0.2416      </span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; less         gplm0  &lt;---   20.3710  6.7406         -27.2606   12.0360                           </span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt; Comparison 2 Results:</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------------------------------- </span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co">#&gt; complexity   model  winner lppd     eff_num_param  WAIC       SE_WAIC    Delta_WAIC SE_Delta_WAIC</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="co">#&gt; more         plm           5.5842   4.2574         -2.6536    6.6635     -0.4066    0.1904      </span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co">#&gt; less         plm0   &lt;---   5.6284   4.0984         -3.0601    6.6931                            </span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="co">#&gt; Comparison 3 Results:</span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------------------------------- </span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="co">#&gt; complexity   model  winner lppd     eff_num_param  WAIC       SE_WAIC    Delta_WAIC SE_Delta_WAIC</span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a><span class="co">#&gt; more         gplm0  &lt;---   20.3710  6.7406         -27.2606   12.0360    24.2005    9.1834      </span></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a><span class="co">#&gt; less         plm0          5.6284   4.0984         -3.0601    6.6931                            </span></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a><span class="co">#&gt; === End of Summary ===</span></span></code></pre></div>
<p>The first round of the tournament favors <code>gplm0</code> over
<code>gplm</code>, and <code>plm0</code> over <code>plm</code>, based on
their respective
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mtext mathvariant="normal">WAIC</mtext></mrow><annotation encoding="application/x-tex">\Delta\text{WAIC}</annotation></semantics></math>
values. In the final round, <code>gplm0</code> emerges as the overall
winner, with a substantial positive
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mtext mathvariant="normal">WAIC</mtext></mrow><annotation encoding="application/x-tex">\Delta\text{WAIC}</annotation></semantics></math>
of ~24 when compared to <code>plm0</code>. This indicates that
<code>gplm0</code> provides the best balance between model complexity
and fit to the data.</p>
<p>The standard error of the estimated WAIC difference, denoted as
<code>SE_Delta_WAIC</code>, is rather large at ~9. This suggests some
uncertainty in the magnitude of this difference. However, it’s important
to note that despite the small sample size, the
<code>SE_Delta_WAIC</code> is less than half the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mtext mathvariant="normal">WAIC</mtext></mrow><annotation encoding="application/x-tex">\Delta\text{WAIC}</annotation></semantics></math>
estimate. This provides some confidence in the preference for
<code>gplm0</code>, as the difference in WAIC is more than two standard
errors away from zero. Lets further investigate this comparison.</p>
</div>
<div class="section level2">
<h2 id="visualizing-the-model-comparisons">Visualizing the model comparisons<a class="anchor" aria-label="anchor" href="#visualizing-the-model-comparisons"></a>
</h2>
<p>To gain deeper insights into the model comparison results, we can use
various visualization tools:</p>
<div class="section level4">
<h4 id="tournament-results-diagram">1. Tournament results diagram:<a class="anchor" aria-label="anchor" href="#tournament-results-diagram"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(t_obj) <span class="co">#default plot type is type='tournament_results'</span></span></code></pre></div>
<p><img src="tournament_files/figure-html/unnamed-chunk-7-1.png" alt="&lt;em&gt;A diagram showing the results of the power-law tournament. The diagram progresses from bottom (four initial models) to top (single winner). Each model's residual plot is shown at the bottom, with corresponding WAIC values above. Green WAIC values indicate the more parsimonious models in each comparison for these data. The first round selects gplm0 and plm0, which advance to the final comparison. gplm0 emerges as the tournament winner, indicated by its green WAIC value and the name at the top of the diagram.&lt;/em&gt;" width="768" style="display: block; margin: auto;"></p>
<p>This diagram illustrates the tournament progression from the initial
four models to the final winner. It shows each model’s residual plot at
the bottom, with corresponding WAIC values above. Green WAIC values
indicate the selected model for each comparison.</p>
</div>
<div class="section level4">
<h4 id="log-likelihood-comparison">2. Log-likelihood comparison:<a class="anchor" aria-label="anchor" href="#log-likelihood-comparison"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(t_obj, <span class="at">type =</span> <span class="st">'boxplot'</span>)</span></code></pre></div>
<p><img src="tournament_files/figure-html/unnamed-chunk-8-1.png" alt="A comparative boxplot displaying posterior log-likelihood values for the models, with corresponding WAIC values shown as red diamonds. The log-likelihood values are presented on the deviance scale for direct comparison with WAIC. Each boxplot represents the distribution of log-likelihood values computed with the samples from the posterior distribution of the corresponding model. This visualization allows for easy comparison of model performance and fit across the four models." width="768" style="display: block; margin: auto;"></p>
<p>This boxplot compares the posterior log-likelihood values for each
model, with the corresponding WAIC values shown as red diamonds. The
log-likelihood values are presented on the deviance scale (-2 *
log-likelihood) for a direct comparison with WAIC. Lower values indicate
better fit.</p>
</div>
<div class="section level4">
<h4 id="rating-curve-comparison">3. Rating curve comparison:<a class="anchor" aria-label="anchor" href="#rating-curve-comparison"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(t_obj, <span class="at">type =</span> <span class="st">'rating_curve'</span>)</span></code></pre></div>
<p><img src="tournament_files/figure-html/unnamed-chunk-9-1.png" alt="A plot comparing the rating curves estimated by four models. The graph shows water level (stage) on the y-axis and discharge on the x-axis. Each model's estimated rating curve is represented by a solid line, with dotted lines showing the 95% prediction interval. This visualization enables assessment of model fit across the range of water levels, highlighting differences in predictive capabilities. Optimal performance is indicated by the solid line following the mean of observations and 95% of observations falling within the prediction interval." width="768" style="display: block; margin: auto;"></p>
<p>This plot compares the estimated rating curves from all four models.
It shows water level (stage) vs. discharge, with solid lines
representing the estimated curves and dotted lines showing 95%
prediction intervals. This visualization helps assess model fit across
different water levels. Optimal model fit is indicated by the solid line
following the mean of observations and 95% of observations falling
within the prediction interval.</p>
</div>
<div class="section level4">
<h4 id="residual-plot-comparison">4. Residual plot comparison:<a class="anchor" aria-label="anchor" href="#residual-plot-comparison"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(t_obj, <span class="at">type =</span> <span class="st">'residuals'</span>)</span></code></pre></div>
<p><img src="tournament_files/figure-html/unnamed-chunk-10-1.png" width="768" style="display: block; margin: auto;"></p>
<p>The residual plots also help assess how well each model fits the data
by showing differences between observed and predicted values across
water levels. This can reveal patterns in model performance and
highlight any systematic under- or over-predictions. Optimal model fit
is indicated by the rating curve mean (solid horizontal line) following
the mean of the observations, and 95% of observations falling within the
95% prediction interval (dotted lines).</p>
</div>
<div class="section level4">
<h4 id="model-component-comparisons">5. Model Component Comparisons:<a class="anchor" aria-label="anchor" href="#model-component-comparisons"></a>
</h4>
<p>The differences between the four models lie in the treatment of the
power-law exponent,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(h)</annotation></semantics></math>,
and the log-error standard deviation,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>σ</mi><mi>ε</mi><mn>2</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sigma^2_{\varepsilon}(h)</annotation></semantics></math>,
as either constants or stage-dependent functions. Therefore, it is
insightful to examine the posterior distributions of these elements
across the different models to determine whether stage dependence exists
or if the assumption of constancy is appropriate.</p>
<div class="section level5">
<h5 id="power-law-exponent-comparison">Power-law exponent comparison:<a class="anchor" aria-label="anchor" href="#power-law-exponent-comparison"></a>
</h5>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(t_obj, <span class="at">type =</span> <span class="st">'f'</span>)</span></code></pre></div>
<p><img src="tournament_files/figure-html/unnamed-chunk-11-1.png" width="768" style="display: block; margin: auto;"></p>
<p>The plots show that the exponent is clearly not constant over the
water elevations. This observation supports the use of the generalized
power-law models (<code>gplm</code> and <code>gplm0</code>) over the
classical power-law models (<code>plm</code> and <code>plm0</code>), as
they allow for this non-constant behavior of the power-law exponent.</p>
</div>
<div class="section level5">
<h5 id="log-error-standard-deviation-comparison">Log-error standard deviation comparison:<a class="anchor" aria-label="anchor" href="#log-error-standard-deviation-comparison"></a>
</h5>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(t_obj, <span class="at">type =</span> <span class="st">'sigma_eps'</span>)</span></code></pre></div>
<p><img src="tournament_files/figure-html/unnamed-chunk-12-1.png" width="768" style="display: block; margin: auto;"></p>
<p>In contrast to the exponent, the log-error standard deviation does
not show a clear non-constant trend over the water elevations. This
observation suggests that models with constant error variance
(<code>plm0</code> and <code>gplm0</code>) might be sufficient for this
dataset, aligning with the tournament results that selected
<code>gplm0</code>.</p>
</div>
</div>
<div class="section level4">
<h4 id="winning-model-panel">6. Winning model panel:<a class="anchor" aria-label="anchor" href="#winning-model-panel"></a>
</h4>
<p>Finally, the <code>panel</code> option is useful to gain insight into
all different model components of the winning model, which in this case
is <code>gplm0</code>:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(t_obj, <span class="at">type =</span> <span class="st">'panel'</span>, <span class="at">transformed =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="tournament_files/figure-html/unnamed-chunk-13-1.png" width="768" style="display: block; margin: auto;"></p>
<p>This panel plot provides a comprehensive view of the winning model’s
components, including the rating curve, residuals, power-law exponent,
and the log-error standard deviation. This visualization is particularly
useful for understanding how the different elements of the winning model
work together and how they relate to the observed data. The
<code>transformed = TRUE</code> argument transforms the rating curve and
observations onto the modeling scale (log-scale).</p>
</div>
</div>
<div class="section level2">
<h2 id="customizing-tournaments">Customizing tournaments<a class="anchor" aria-label="anchor" href="#customizing-tournaments"></a>
</h2>
<p>There are several ways to customize the tournament further:</p>
<div class="section level4">
<h4 id="fixing-the-c-parameters">1. Fixing the <code>c</code> parameters:<a class="anchor" aria-label="anchor" href="#fixing-the-c-parameters"></a>
</h4>
<p>If the parameter of zero discharge
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
is known, you might want to fix that parameter to the known value in the
model. Assume
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>7.65</mn><annotation encoding="application/x-tex">7.65</annotation></semantics></math>
m is the known value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>.
Then you can directly run a tournament with the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
parameter fixed in all the models:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="sc">&gt;</span> t_obj_known_c <span class="ot">&lt;-</span> <span class="fu">tournament</span>(<span class="at">formula =</span> Q <span class="sc">~</span> W , <span class="at">data =</span> krokfors, <span class="at">c_param =</span> <span class="fl">7.65</span>)</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="adjusting-the-winning-criteria">2. Adjusting the winning criteria:<a class="anchor" aria-label="anchor" href="#adjusting-the-winning-criteria"></a>
</h4>
<p>You can change the winning criteria (default value = 2) which sets
the threshold that the more complex model in each model comparison must
exceed. For example, increasing the value to
<code>winning_criteria = 5</code> raises the threshold, thus favoring
model simplicity more. To re-evaluate a previously run tournament using
a different winning criteria, you can simply the <code>summary</code>
function:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(t_obj, <span class="at">winning_criteria =</span> <span class="dv">5</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">#&gt; === Tournament Model Comparison Summary ===</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">#&gt; Method: WAIC </span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co">#&gt; Winning Criteria: Delta_WAIC &gt; 5 </span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co">#&gt; Overall Winner: gplm0 </span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co">#&gt; Comparison 1 Results:</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------------------------------- </span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt; complexity   model  winner lppd     eff_num_param  WAIC       SE_WAIC    Delta_WAIC SE_Delta_WAIC</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt; more         gplm          20.7794  6.8706         -27.8176   11.8918    0.5570     0.2416      </span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">#&gt; less         gplm0  &lt;---   20.3710  6.7406         -27.2606   12.0360                           </span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co">#&gt; Comparison 2 Results:</span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------------------------------- </span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="co">#&gt; complexity   model  winner lppd     eff_num_param  WAIC       SE_WAIC    Delta_WAIC SE_Delta_WAIC</span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#&gt; more         plm           5.5842   4.2574         -2.6536    6.6635     -0.4066    0.1904      </span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co">#&gt; less         plm0   &lt;---   5.6284   4.0984         -3.0601    6.6931                            </span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="co">#&gt; Comparison 3 Results:</span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------------------------------- </span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="co">#&gt; complexity   model  winner lppd     eff_num_param  WAIC       SE_WAIC    Delta_WAIC SE_Delta_WAIC</span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a><span class="co">#&gt; more         gplm0  &lt;---   20.3710  6.7406         -27.2606   12.0360    24.2005    9.1834      </span></span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a><span class="co">#&gt; less         plm0          5.6284   4.0984         -3.0601    6.6931                            </span></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a><span class="co">#&gt; === End of Summary ===</span></span></code></pre></div>
<p>For the method <code>"WAIC"</code>, you can also specify a more
complex winning criteria as a string expression:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(t_obj, <span class="at">winning_criteria =</span> <span class="st">"Delta_WAIC &gt; 2 &amp; Delta_WAIC - SE_Delta_WAIC &gt; 0"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co">#&gt; === Tournament Model Comparison Summary ===</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co">#&gt; Method: WAIC </span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt; Winning Criteria: Delta_WAIC &gt; 2 &amp; Delta_WAIC - SE_Delta_WAIC &gt; 0 </span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt; Overall Winner: gplm0 </span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt; Comparison 1 Results:</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------------------------------- </span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt; complexity   model  winner lppd     eff_num_param  WAIC       SE_WAIC    Delta_WAIC SE_Delta_WAIC</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt; more         gplm          20.7794  6.8706         -27.8176   11.8918    0.5570     0.2416      </span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt; less         gplm0  &lt;---   20.3710  6.7406         -27.2606   12.0360                           </span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt; Comparison 2 Results:</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------------------------------- </span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt; complexity   model  winner lppd     eff_num_param  WAIC       SE_WAIC    Delta_WAIC SE_Delta_WAIC</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt; more         plm           5.5842   4.2574         -2.6536    6.6635     -0.4066    0.1904      </span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#&gt; less         plm0   &lt;---   5.6284   4.0984         -3.0601    6.6931                            </span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="co">#&gt; Comparison 3 Results:</span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------------------------------- </span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a><span class="co">#&gt; complexity   model  winner lppd     eff_num_param  WAIC       SE_WAIC    Delta_WAIC SE_Delta_WAIC</span></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a><span class="co">#&gt; more         gplm0  &lt;---   20.3710  6.7406         -27.2606   12.0360    24.2005    9.1834      </span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a><span class="co">#&gt; less         plm0          5.6284   4.0984         -3.0601    6.6931                            </span></span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a><span class="co">#&gt; === End of Summary ===</span></span></code></pre></div>
<p>This criteria requires that the difference in WAIC is greater than 2
and that this difference minus its standard error is greater than 0,
providing a more conservative approach to model selection.</p>
<p>Note: Only <code>Delta_WAIC</code> and <code>SE_Delta_WAIC</code> are
allowed as variables in the winning_criteria expressions.</p>
</div>
<div class="section level4">
<h4 id="changing-the-model-comparison-method">3. Changing the model comparison method:<a class="anchor" aria-label="anchor" href="#changing-the-model-comparison-method"></a>
</h4>
<p>The default method is <code>"WAIC"</code>, but you can also use
<code>"DIC"</code> or <code>"PMP"</code>:</p>
<ul>
<li>
<p><code>"WAIC"</code> (default):</p>
<p>WAIC (Watanabe, 2010) is a fully Bayesian method that uses the full
set of posterior draws to calculate the best possible estimate of the
expected log pointwise predictive density.</p>
</li>
<li>
<p><code>"DIC"</code>:</p>
<p>DIC (Spiegelhalter, 2002) is similar to WAIC but uses a point
estimate of the posterior distribution instead of the full set of
posterior draws.</p>
</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(t_obj, <span class="at">method =</span> <span class="st">"DIC"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co">#&gt; === Tournament Model Comparison Summary ===</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co">#&gt; Method: DIC </span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co">#&gt; Winning Criteria: Delta_DIC &gt; 2 </span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co">#&gt; Overall Winner: gplm0 </span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="co">#&gt; Comparison 1 Results:</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------- </span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="co">#&gt; complexity   model  winner D_hat      eff_num_param  DIC        Delta_DIC </span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="co">#&gt; more         gplm          -42.7732   6.0631         -30.6471   0.8498    </span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="co">#&gt; less         gplm0  &lt;---   -42.4880   6.3454         -29.7972             </span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a><span class="co">#&gt; Comparison 2 Results:</span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------- </span></span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a><span class="co">#&gt; complexity   model  winner D_hat      eff_num_param  DIC        Delta_DIC </span></span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a><span class="co">#&gt; more         plm           -11.3400   2.9739         -5.3923    -0.3058   </span></span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a><span class="co">#&gt; less         plm0   &lt;---   -11.4712   2.8865         -5.6982              </span></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a><span class="co">#&gt; Comparison 3 Results:</span></span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------- </span></span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a><span class="co">#&gt; complexity   model  winner D_hat      eff_num_param  DIC        Delta_DIC </span></span>
<span id="cb16-24"><a href="#cb16-24" tabindex="-1"></a><span class="co">#&gt; more         gplm0  &lt;---   -42.4880   6.3454         -29.7972   24.0991   </span></span>
<span id="cb16-25"><a href="#cb16-25" tabindex="-1"></a><span class="co">#&gt; less         plm0          -11.4712   2.8865         -5.6982              </span></span>
<span id="cb16-26"><a href="#cb16-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-27"><a href="#cb16-27" tabindex="-1"></a><span class="co">#&gt; === End of Summary ===</span></span></code></pre></div>
<ul>
<li>
<p><code>"PMP"</code> (posterior model probabilities):</p>
<p>The posterior model probabilities are computed with Bayes factors
(Jeffreys, 1961; Kass and Raftery, 1995), assuming all models are
equally likely a priori. The winning criteria for method
<code>"PMP"</code> should be between 0 and 1, representing the threshold
for the posterior probability of the more complex model. The default is
0.75, which should give similar results to the other two methods with
their respective default values of 2. The method <code>"PMP"</code> is
not chosen as the default method because the Bayes factor calculations
can be quite unstable. Let’s now use this method, but raise the winning
criteria from 0.75 to 0.9</p>
</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(t_obj, <span class="at">method =</span> <span class="st">"PMP"</span>, <span class="at">winning_criteria =</span> <span class="fl">0.9</span>)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="co">#&gt; === Tournament Model Comparison Summary ===</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="co">#&gt; Method: PMP </span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="co">#&gt; Winning Criteria: PMP of more complex model &gt; 0.9 </span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="co">#&gt; Overall Winner: gplm0 </span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="co">#&gt; Comparison 1 Results:</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------------------- </span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co">#&gt; complexity   model  winner log_marg_lik         PMP            </span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co">#&gt; more         gplm          10.1504              0.4538         </span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">#&gt; less         gplm0  &lt;---   10.3357              0.5462         </span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a><span class="co">#&gt; Comparison 2 Results:</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------------------- </span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a><span class="co">#&gt; complexity   model  winner log_marg_lik         PMP            </span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a><span class="co">#&gt; more         plm    &lt;---   0.9781               0.9260         </span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="co">#&gt; less         plm0          -1.5486              0.0740         </span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a><span class="co">#&gt; Comparison 3 Results:</span></span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------------------- </span></span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a><span class="co">#&gt; complexity   model  winner log_marg_lik         PMP            </span></span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a><span class="co">#&gt; more         gplm0  &lt;---   10.3357              0.9999         </span></span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a><span class="co">#&gt; less         plm           0.9781               0.0001         </span></span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a><span class="co">#&gt; === End of Summary ===</span></span>
<span id="cb17-28"><a href="#cb17-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-29"><a href="#cb17-29" tabindex="-1"></a><span class="co">#&gt; ⚠ Warning: The Harmonic Mean Estimator (HME) is used to estimate the Bayes Factor for the posterior model probability (PMP), which is known to be unstable and potentially unreliable. We recommend using method "WAIC" (Widely Applicable Information Criterion) for model comparison instead.</span></span></code></pre></div>
<p>Note that when using the summary function to change the method or
winning criteria, the tournament is re-run with the new parameters using
the original contestant models. This allows for efficient comparison of
different methods or criteria without having to refit the models.</p>
<p>These examples demonstrate how different methods and winning criteria
can be applied to model comparison. While it’s valuable to explore these
options, we generally recommend using the WAIC method, as it provides a
robust and theoretically sound approach to model selection. WAIC uses
the full posterior distribution and is particularly well-suited for
hierarchical models.</p>
<p>In the case of the Krokfors dataset, we see that the results of the
tournament do not change despite these customizations, and the winner of
the third and final comparison is still <code>gplm0</code>. This
consistency across different methods and criteria suggests that
<code>gplm0</code> is indeed the most appropriate model for this
particular dataset.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Burnham, K. P. and Anderson, D. R. (eds) (2002). <em>Information and
Likelihood Theory: A Basis for Model Selection and Inference</em>. New
York, NY: Springer New York. 49–97, doi: <a href="https://doi.org/10.1007/978-0-387-22456-5_2" class="external-link uri">https://doi.org/10.1007/978-0-387-22456-5_2</a></p>
<p>Hrafnkelsson, B., Sigurdarson, H., Rögnvaldsson, S., Jansson, A. Ö.,
Vias, R. D., and Gardarsson, S. M. (2022). <em>Generalization of the
power-law rating curve using hydrodynamic theory and Bayesian
hierarchical modeling</em>, Environmetrics, 33(2):e2711. doi: <a href="https://doi.org/10.1002/env.2711" class="external-link uri">https://doi.org/10.1002/env.2711</a></p>
<p>Jeffreys, H. (1961). <em>Theory of Probability</em>, Third Edition.
Oxford University Press.</p>
<p>Kass, R., and A. Raftery, A. (1995). <em>Bayes Factors</em>. Journal
of the American Statistical Association, 90, 773-795. doi: <a href="https://doi.org/10.1080/01621459.1995.10476572" class="external-link uri">https://doi.org/10.1080/01621459.1995.10476572</a></p>
<p>Spiegelhalter, D., Best, N., Carlin, B., Van Der Linde, A. (2002).
<em>Bayesian measures of model complexity and fit</em>. Journal of the
Royal Statistical Society: Series B (Statistical Methodology) 64(4),
583–639. doi: <a href="https://doi.org/10.1111/1467-9868.00353" class="external-link uri">https://doi.org/10.1111/1467-9868.00353</a></p>
<p>Watanabe, S. (2010). <em>Asymptotic equivalence of Bayes cross
validation and widely applicable information criterion in singular
learning theory</em>. Journal of Machine Learning Research, 11,
3571–3594.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://english.hi.is/staff/birgirhr" class="external-link">Birgir Hrafnkelsson</a>, <a href="https://github.com/sor16" class="external-link">Solvi Rognvaldsson</a>, <a href="https://github.com/axelornj" class="external-link">Axel Orn Jansson</a>, Rafael Daníel Vias.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
