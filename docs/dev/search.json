[{"path":"https://sor16.github.io/bdrc/dev/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2021 Birgir Hrafnkelsson Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://sor16.github.io/bdrc/dev/articles/background.html","id":"bayesian-generalized-power-law-rating-curves","dir":"Articles","previous_headings":"","what":"Bayesian Generalized Power-Law Rating Curves","title":"Background","text":"power-law model commonly assumed hydraulic practice fit rating curves, mention , form Q(h)=(h−c)bQ(h) = (h-c)^{b} (1) QQ, hh, aa, bb cc , see e.g., Venetis (1970), Clarke (1999) Clarke et al. (2000). second type rating curve generalized power-law rating curve. construction based hydraulics open channel flow given formulas Chézy Manning form Q=KRxAS1/2Q = KR^{x}^{1/2} (2) KK xx constants; AA area cross section; SS slope channel; RR hydraulic radius, given R=/PR = /P, PP wetted perimeter. According Chézy x=1/2x = 1/2, Manning claimed x=2/3x = 2/3 (Chow, 1959). form generalized power-law rating curve Q=(h−c)f(h)Q = (h − c)^{f(h)} (3) aa cc constants; f(h)f(h) function hh, referred power-law exponent. relationship (2) (3) can found equating two equations. particular, form f(h)f(h) can derived, namely, f(h)=(x+1){logA(h)−logA(1)}−x{logP(h)−logP(1)}loghf(h) = \\frac{(x+1)\\{ \\log (h) - \\log (1) \\}  - x \\{ \\log P(h) - \\log P(1)  \\}}{\\log h} (4) Thus, f(h)f(h) function constant xx, cross-sectional area AA, wetted perimeter PP. Bayesian approach proposed estimating parameters power-law model generalized power-law model. Bayesian inference requires specification prior densities unknown parameters unknown quantities, along full probabilistic specification observed data. goal Bayesian inference obtain posterior density model parameters, interrogate posterior calculating summary statistics, posterior mean 95% posterior intervals.  Analytical formulas summary statistics intractable cases thus computed generating samples posterior density using Markov chain Monte Carlo simulation. Bayesian power-law model presented logarithmic scale , log(Qi)=log()+blog(hi−c)+ϵi,=1,...,n,\\log(Q_i) = \\log() + b \\log(h_i -c) + \\epsilon_i, \\quad = 1,...,n, (5) ϵi\\epsilon_i follows normal distribution mean zero variance σϵ2\\sigma_{\\epsilon}^2, nn number paired observations, aa, bb cc . Bayesian inference scheme implemented power-law model standard, however, efficient posterior simulation, first, samples obtained joint marginal posterior density (c,σϵ2)(c, \\sigma_{\\epsilon}^2), samples obtained conditional posterior density (log(),b)(\\log(), b) conditional (c,σϵ2)(c, \\sigma_{\\epsilon}^2). Bayesian generalized power-law model presented Bayesian hierarchical model. function f(h)f(h) modeled latent level bb plus mean zero continuous stochastic process β(h)\\beta(h), assumed twice mean-square differentiable. model presented logarithmic scale , log(Qi)=log()+(b+β(hi))log(hi−c)+εi,=1,...,n,\\log (Q_i) = \\log () + (b + \\beta(h_i)) \\log(h_i -c) + \\varepsilon_i, \\quad = 1,...,n, (6) ϵi\\epsilon_i follows normal distribution mean zero variance σϵ2(hi)\\sigma_{\\epsilon}^2(h_i) can vary water elevation. parameters aa, bb cc play similar role Bayesian power-law model. stochastic process β(h)\\beta(h) assumed priori Gaussian process governed Matérn covariance function smoothness parameter ν=2.5\\nu = 2.5, see Matérn (1960). model constrained setting b=1.835b=1.835. efficient posterior simulation achieved sampling joint posterior density hyperparameters model, sampling conditional density latent parameters given hyperparameters.","code":""},{"path":"https://sor16.github.io/bdrc/dev/articles/background.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Background","text":"Chow, V. (1959). Open-Channel Hydraulics. McGraw-Hill. New York. Clarke, R. (1999). Uncertainty estimation mean annual flood due rating-curve indefinition. Journal Hydrology 222(1-4). 185–190. doi: https://doi.org/10.1016/s0022-1694(99)00097-9 Clarke, R., Mendiondo, E., Brusa L. (2000). Uncertainties mean discharges two large South American rivers due rating curve variability. Hydrological Sciences 45(2). 221–236. doi: https://doi.org/10.1080/02626660009492321 Hrafnkelsson, B., Sigurdarson, H., Rögnvaldsson, S., Jansson, . Ö., Vias, R. D., Gardarsson, S. M. (2022). Generalization power-law rating curve using hydrodynamic theory Bayesian hierarchical modeling, Environmetrics, 33(2):e2711. doi: https://doi.org/10.1002/env.2711 Matérn, B. (1960). Spatial variation. Stochastic models application problems forest surveys sampling investigations. Meddelanden från statens Skogsforskningsinstitut. 49(5). Venetis, C. (1970). note estimation parameters logarithmic stage-discharge relationships estimates error. International Association Scientific Hydrology. Bulletin XV 2(6). 105–111. doi: https://doi.org/10.1080/02626667009493957","code":""},{"path":"https://sor16.github.io/bdrc/dev/articles/introduction.html","id":"fitting-a-discharge-rating-curve","dir":"Articles","previous_headings":"","what":"Fitting a discharge rating curve","title":"Introduction","text":"simple fit discharge rating curve bdrc package. need two mandatory input arguments, formula data. formula form y~x, y discharge square meters per second (m3/^3/s), x water elevation meters (m). important data correct units! data argument must data.frame including x y column names. case, Krokfors data discharge water elevation measurements stored columns named Q W, respectively. ready fit discharge rating curve using gplm function: function prints summary fitting process key MCMC diagnostics. include acceptance rate, chain mixing (assessed via Gelman-Rubin statistic, R̂\\hat{R}), effective sample sizes. checkmarks (✔) indicate algorithm met important criteria reliability. However, sometimes may encounter warnings (⚠). example: warning suggests certain parameters (case, sigma_eta) haven’t mixed well across chains, affect reliability results. cases, function provides advice: output helps assess whether discharge rating curve fitted successfully reliably using specified data. function can made run silently setting verbose=FALSE. Note parallel=TRUE default setting, utilizing available cores machine. can adjust number cores num_cores argument needed. gplm function returns object class gplm can summarize visualize using familiar functions  next section, dive deeper visualizing gplm object.","code":"> gplm.fit <- gplm(Q ~ W, data = krokfors, parallel = TRUE, num_cores = 2) # by default parallel=TRUE and the number of cores is detected on the machine #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 25.33%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). #> ⚠ Warning: Some chains are not mixing well. Parameters with Rhat > 1.1: #>   - sigma_eta: Rhat = 1.281 #> ℹ Try re-running the model after inspecting the trace plots, convergence diagnostics plots, and reviewing the data for potential issues. > summary(gplm.fit) #>  #> Formula:  #>  Q ~ W #> Latent parameters: #>   lower-2.5% median-50% upper-97.5% #> a 1.47       1.94       2.23        #> b 1.83       1.84       1.84        #>  #> Hyperparameters: #>            lower-2.5% median-50% upper-97.5% #> c           7.70955    7.8089     7.855      #> sigma_beta  0.42275    0.6942     1.258      #> phi_beta    0.54941    1.1775     2.861      #> sigma_eta   0.00298    0.0934     0.498      #> eta_1      -4.91521   -4.2508    -3.535      #> eta_2      -5.97953   -4.0555    -2.264      #> eta_3      -6.92387   -4.1874    -1.612      #> eta_4      -7.66667   -4.4852    -1.160      #> eta_5      -8.33270   -4.6096    -0.757      #> eta_6      -8.81259   -4.6718    -0.311      #>  #> WAIC: -27.81763 > plot(gplm.fit)"},{"path":"https://sor16.github.io/bdrc/dev/articles/introduction.html","id":"visualizing-posterior-distributions-of-different-parameters","dir":"Articles","previous_headings":"","what":"Visualizing posterior distributions of different parameters","title":"Introduction","text":"bdrc package provides several tools visualize results model objects can give insight physical properties river hand. instance, hyperparameter cc corresponds water elevation zero discharge. visualize posterior cc, can write  Technically, instead inferring cc directly, hmin−ch_{min}-c inferred, hminh_{min} lowest water elevation value data. Since parameter hmin−ch_{min}-c strictly positive, transformation ζ=log(hmin−c)\\zeta=log(h_{min}-c) used Bayesian inference support real line. plot transformed posterior write  param argument can also vector containing multiple parameter names. example, visualize posterior distributions parameters aa cc, can write  shorthand visualize hyperparameters  Similarly, writing \"latent_parameters\" plots latent parameters one plot. plot hyperparameters transformed scale Bayesian inference, write  Finally, can visualize components model allowed (depending model) vary water elevation, , power-law exponent, f(h)f(h), standard deviation error terms response level, σε(h)\\sigma_{\\varepsilon}(h). gplm0 gplm generalize power-law exponent modeling sum constant term, bb, Gaussian process, β(h)\\beta(h), namely f(h)=b+β(h)f(h)=b+\\beta(h), β(h)\\beta(h) assumed twice differentiable mean zero. hand, plm plm0 model power-law exponent constant setting β(h)=0\\beta(h)=0, gives f(h)=bf(h)=b. can plot inferred power-law exponent  plm gplm model standard deviation error terms response level, σε(h)\\sigma_{\\varepsilon}(h), function water elevation, using B-splines basis functions, plm0 gplm0 model standard deviation constant. can plot inferred standard deviation writing  get visual summary model, \"panel\" option plot type useful:","code":"> plot(gplm.fit, type = 'histogram', param = 'c') > plot(gplm.fit, type = 'histogram', param = 'c', transformed = TRUE) > plot(gplm.fit, type = 'histogram', param = c('a', 'c')) > plot(gplm.fit, type = 'histogram', param = 'hyperparameters') > plot(gplm.fit, type = 'histogram', param = 'hyperparameters', transformed = TRUE) > plot(gplm.fit, type = 'f') > plot(gplm.fit, type = 'sigma_eps') > plot(gplm.fit, type = 'panel', transformed = TRUE)"},{"path":"https://sor16.github.io/bdrc/dev/articles/introduction.html","id":"assessing-model-fit-and-convergence","dir":"Articles","previous_headings":"","what":"Assessing model fit and convergence","title":"Introduction","text":"package several functions convergence diagnostics bdrc model, notably residual plot, trace plots, autocorrelation plots, Gelman-Rubin diagnostic plots. log-residuals can plotted  log-residuals calculated subtracting posterior estimate (median) log-discharge, log(Q̂)log(\\hat{Q}), observed log-discharge, log(Q)log(Q). Additionally, plot includes 95% predictive intervals log(Q)\\log(Q) (- -) 95% credible intervals expected value log(Q)\\log(Q) (—), latter reflecting rating curve uncertainty.  plot trace plot transformed hyperparameters, write  assess mixing convergence MCMC chains parameter, can visualize Gelman-Rubin statistic, R̂\\hat{R}, presented Gelman Rubin (1992) :  finally, autocorrelation parameters can assessed ","code":"> plot(gplm.fit, type = 'residuals') > plot(gplm.fit, type = 'trace', param = 'c', transformed = TRUE) > plot(gplm.fit, type = 'trace', param = 'hyperparameters', transformed = TRUE) > plot(gplm.fit, type = 'r_hat') > plot(gplm.fit, type = 'autocorrelation')"},{"path":"https://sor16.github.io/bdrc/dev/articles/introduction.html","id":"customizing-the-models","dir":"Articles","previous_headings":"","what":"Customizing the models","title":"Introduction","text":"ways customize gplm function. instances, parameter zero discharge, cc, known, might want fix model parameter known value. addition, might want extrapolate rating curve higher water elevation values adjusting maximum water elevation. Assume 7.65 m known value cc want calculate rating curve water elevation values 10 m, function call look like ","code":"> gplm.fit.known_c <- gplm(Q ~ W, krokfors, c_param = 7.65, h_max = 10, parallel = FALSE)"},{"path":"https://sor16.github.io/bdrc/dev/articles/introduction.html","id":"prediction-for-an-equally-spaced-grid-of-water-elevations","dir":"Articles","previous_headings":"","what":"Prediction for an equally spaced grid of water elevations","title":"Introduction","text":"get rating curve predictions equally spaced grid water elevation values, can use predict function. Note values range cc h_max accepted, range Bayesian inference performed","code":"> h_grid <- seq(8, 9, by = 0.01) > rating_curve_h_grid <- predict(gplm.fit, newdata = h_grid) > print(rating_curve_h_grid) #>        h      lower     median     upper #> 1   8.00 0.06138853 0.08252241 0.1108601 #> 2   8.01 0.06708762 0.09009315 0.1207313 #> 3   8.02 0.07340524 0.09850833 0.1316830 #> 4   8.03 0.07972287 0.10692352 0.1426346 #> 5   8.04 0.08620981 0.11547827 0.1537808 #> 6   8.05 0.09363849 0.12480929 0.1660087 #> 7   8.06 0.10106716 0.13414031 0.1782366 #> 8   8.07 0.10861541 0.14364701 0.1906011 #> 9   8.08 0.11657272 0.15375469 0.2034327 #> 10  8.09 0.12453002 0.16386237 0.2162643 #> 11  8.10 0.13257126 0.17428375 0.2295413 #> 12  8.11 0.14080833 0.18543710 0.2438577 #> 13  8.12 0.14904540 0.19659045 0.2581741 #> 14  8.13 0.15728247 0.20774380 0.2724905 #> 15  8.14 0.16662200 0.21960922 0.2875367 #> 16  8.15 0.17662981 0.23190628 0.3030253 #> 17  8.16 0.18663761 0.24420333 0.3185138 #> 18  8.17 0.19681441 0.25692028 0.3351942 #> 19  8.18 0.20699699 0.26965158 0.3519154 #> 20  8.19 0.21718541 0.28270330 0.3691020 #> 21  8.20 0.22738677 0.29646391 0.3873184 #> 22  8.21 0.23758814 0.31022451 0.4055347 #> 23  8.22 0.24864524 0.32456916 0.4240212 #> 24  8.23 0.26015179 0.33922056 0.4426497 #> 25  8.24 0.27165833 0.35387195 0.4612783 #> 26  8.25 0.28286178 0.36952305 0.4822933 #> 27  8.26 0.29406524 0.38517416 0.5033083 #> 28  8.27 0.30595170 0.40092441 0.5238623 #> 29  8.28 0.31861873 0.41678798 0.5438895 #> 30  8.29 0.33128577 0.43265156 0.5639167 #> 31  8.30 0.34430822 0.44895462 0.5841702 #> 32  8.31 0.35735607 0.46528907 0.6044400 #> 33  8.32 0.37077354 0.48265853 0.6264057 #> 34  8.33 0.38474546 0.50158052 0.6509156 #> 35  8.34 0.39867565 0.51991036 0.6752141 #> 36  8.35 0.41257803 0.53784545 0.6993718 #> 37  8.36 0.42648262 0.55691726 0.7236054 #> 38  8.37 0.44038777 0.57627326 0.7478580 #> 39  8.38 0.45757675 0.59494617 0.7736702 #> 40  8.39 0.47458478 0.61391168 0.7996598 #> 41  8.40 0.48996432 0.63551057 0.8272457 #> 42  8.41 0.50534386 0.65710945 0.8548316 #> 43  8.42 0.52119168 0.67855639 0.8824809 #> 44  8.43 0.53827408 0.69960274 0.9102975 #> 45  8.44 0.55535648 0.72064909 0.9381141 #> 46  8.45 0.57229711 0.74245300 0.9669301 #> 47  8.46 0.58906448 0.76518282 0.9969676 #> 48  8.47 0.60583185 0.78791264 1.0270050 #> 49  8.48 0.62287788 0.81159005 1.0567058 #> 50  8.49 0.64009109 0.83583600 1.0862046 #> 51  8.50 0.65730430 0.86008196 1.1157034 #> 52  8.51 0.67837959 0.88498753 1.1480607 #> 53  8.52 0.70042041 0.91005801 1.1811327 #> 54  8.53 0.72142896 0.93588196 1.2163209 #> 55  8.54 0.74158344 0.96232931 1.2532602 #> 56  8.55 0.76152777 0.98908548 1.2891070 #> 57  8.56 0.78096859 1.01658161 1.3223361 #> 58  8.57 0.80060626 1.04414468 1.3558233 #> 59  8.58 0.82476789 1.07324641 1.3952421 #> 60  8.59 0.84892951 1.10234815 1.4346609 #> 61  8.60 0.87309114 1.13144988 1.4740798 #> 62  8.61 0.89805719 1.16190150 1.5167752 #> 63  8.62 0.92318652 1.19262710 1.5601358 #> 64  8.63 0.94831584 1.22335271 1.6034963 #> 65  8.64 0.97416393 1.25588235 1.6435993 #> 66  8.65 1.00045096 1.28951372 1.6817129 #> 67  8.66 1.02673799 1.32314508 1.7198264 #> 68  8.67 1.05323814 1.35749266 1.7615471 #> 69  8.68 1.08004443 1.39286907 1.8084491 #> 70  8.69 1.10685073 1.42824549 1.8553512 #> 71  8.70 1.13446515 1.46428733 1.9034120 #> 72  8.71 1.16531211 1.50299087 1.9561078 #> 73  8.72 1.19615906 1.54169441 2.0088036 #> 74  8.73 1.22700601 1.58039795 2.0614994 #> 75  8.74 1.25816709 1.62314579 2.1156189 #> 76  8.75 1.28935106 1.66618825 2.1698421 #> 77  8.76 1.32053502 1.70923071 2.2240654 #> 78  8.77 1.35520242 1.75289393 2.2817313 #> 79  8.78 1.39163095 1.79687098 2.3411376 #> 80  8.79 1.42805948 1.84084804 2.4005440 #> 81  8.80 1.46619139 1.88627784 2.4612200 #> 82  8.81 1.50691812 1.93392065 2.5238301 #> 83  8.82 1.54764484 1.98156346 2.5864402 #> 84  8.83 1.58862486 2.03029283 2.6504561 #> 85  8.84 1.63132425 2.08639792 2.7240155 #> 86  8.85 1.67402364 2.14250302 2.7975749 #> 87  8.86 1.71672303 2.19860812 2.8711343 #> 88  8.87 1.75942242 2.25471321 2.9446937 #> 89  8.88 1.80704534 2.31372231 3.0198513 #> 90  8.89 1.85677834 2.37397599 3.0956939 #> 91  8.90 1.90651135 2.43422966 3.1715365 #> 92  8.91 1.95757124 2.49992659 3.2569746 #> 93  8.92 2.00910082 2.56755028 3.3458092 #> 94  8.93 2.06063040 2.63517398 3.4346439 #> 95  8.94 2.11134284 2.70513427 3.5158612 #> 96  8.95 2.16182095 2.77576464 3.5948940 #> 97  8.96 2.21229905 2.84639502 3.6739268 #> 98  8.97 2.27542455 2.92460537 3.7803344 #> 99  8.98 2.34140761 3.00452835 3.8929271 #> 100 8.99 2.40739067 3.08445133 4.0055198 #> 101 9.00 2.47424093 3.16576470 4.1159444"},{"path":"https://sor16.github.io/bdrc/dev/articles/introduction.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Introduction","text":"Gelman, ., & Rubin, D. B. (1992). Inference iterative simulation using multiple sequences, Statistical Science, 7(4), 457–472. doi: https://doi.org/10.1214/ss/1177011136 Hrafnkelsson, B., Sigurdarson, H., Rögnvaldsson, S., Jansson, . Ö., Vias, R. D., Gardarsson, S. M. (2022). Generalization power-law rating curve using hydrodynamic theory Bayesian hierarchical modeling, Environmetrics, 33(2):e2711. doi: https://doi.org/10.1002/env.2711","code":""},{"path":"https://sor16.github.io/bdrc/dev/articles/tournament.html","id":"running-a-tournament","dir":"Articles","previous_headings":"","what":"Running a tournament","title":"Tournament - Model comparison","text":"tournament function easy use. need two mandatory input arguments: formula data. formula form y ~ x, y discharge m3/^3/s, x water elevation m (important data correct units). data argument must data.frame including x y column names. case, dataset Krokfors column named Q includes discharge measurements, column W includes water elevation measurements. ready run first tournament: function runs four models tournament. already run four different kinds models, plm0, plm, gplm0 gplm, stored objects, say plm0.fit, plm.fit, gplm0.fit gplm.fit, can alternatively run tournament efficiently following way: Evaluating tournament object gives name winner detailed summary results tournament, write Notice round 1, gplm0 favored gplm first game, plm0 plm second. second round, gplm0 deemed tournament winner, .e., model provides best simplicity goodness--fit trade-data hand.","code":"> set.seed(1) # set seed for reproducibility > t_obj <- tournament(Q ~ W, krokfors, parallel = TRUE, num_cores = 2) # by default parallel=TRUE and the number of cores is detected on the machine #> Running tournament [                                                ] 0% #>  #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 25.33%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). #>  #> - gplm finished  [============                                    ] 25% #>  #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 31.14%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). #>  #> - gplm0 finished [========================                        ] 50% #>  #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 25.66%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). #>  #> - plm finished   [====================================            ] 75% #>  #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 36.04%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). #>  #> - plm0 finished  [================================================] 100% #>  #> Tournament winner: gplm0 > t_obj <- tournament(list(plm0.fit, plm.fit, gplm0.fit, gplm.fit)) > t_obj # or alternatively print(t_obj) #> Tournament winner: gplm0 > summary(t_obj) #>   round game model      lppd eff_num_param       WAIC Delta_WAIC winner #> 1     1    1  gplm 20.779382      6.870566 -27.817631  0.5570133  FALSE #> 2     1    1 gplm0 20.370954      6.740645 -27.260617         NA   TRUE #> 3     1    2   plm  5.584163      4.257375  -2.653577 -0.4065514  FALSE #> 4     1    2  plm0  5.628423      4.098359  -3.060129         NA   TRUE #> 5     2    3 gplm0 20.370954      6.740645 -27.260617 24.2004887   TRUE #> 6     2    3  plm0  5.628423      4.098359  -3.060129         NA  FALSE"},{"path":"https://sor16.github.io/bdrc/dev/articles/tournament.html","id":"comparing-different-components-of-the-models","dir":"Articles","previous_headings":"","what":"Comparing different components of the models","title":"Tournament - Model comparison","text":"several tools visualize different aspects model comparison. get visual summary results different games tournament, write  informative way comparing goodness--fit models compare posteriors log-likelihood values. values often shown deviance scale, .e., minus 2 times log-likelihood. lower value deviance scale implies better fit data. plot boxplot posterior log-likelihood values model, write  red diamonds plot denote WAIC values respective models. Next, plot four rating curves estimated different models, write  Another useful plot residual plot  differences four models lie modeling power-law exponent, f(h)f(h), error variance response level, σε2(h)\\sigma^2_{\\varepsilon}(h). Thus, insightful look posterior power-law exponent different models  standard deviation error terms response level  Finally, panel option useful gain insight different model components winning model, case gplm0:","code":"> plot(t_obj) #default plot type is type='tournament_results' > plot(t_obj, type = 'boxplot') > plot(t_obj, type = 'rating_curve') > plot(t_obj, type = 'residuals') > plot(t_obj, type = 'f') > plot(t_obj, type = 'sigma_eps') > plot(t_obj, type = 'panel', transformed = TRUE)"},{"path":"https://sor16.github.io/bdrc/dev/articles/tournament.html","id":"customizing-tournaments","dir":"Articles","previous_headings":"","what":"Customizing tournaments","title":"Tournament - Model comparison","text":"ways customize tournament . example, parameter zero discharge cc known, might want fix parameter known value model. Assume 7.657.65 m known value cc. can directly run tournament cc parameter fixed models One can also change winning criteria (default value = 2) sets threshold complex model model comparison must exceed, terms model comparison criteria (default method \"WAIC\"). example, increasing value winning_criteria = 5 raises threshold complex model must exceed win game, thus favoring model simplicity default value 2 used. re-evaluate previously run tournament using different winning criteria, efficient way input list stored model objects existing tournament object. case tournament stored t_obj, can write also option change method used estimate predictive performance models. default method \"WAIC\" (see Watanabe (2010)) fully Bayesian method uses full set posterior draws calculate best possible estimate expected log pointwise predictive density. allowed methods \"DIC\" \"PMP\". DIC (see Spiegelhalter (2002)) similar WAIC instead using full set posterior draws compute estimate expected log pointwise predictive density, uses point estimate posterior distribution. methods \"WAIC\" \"DIC\" default value 2 winning criteria. run efficient re-evaluation tournament third final method can chosen \"PMP\", uses posterior model probabilities, calculated Bayes factor (see Jeffreys (1961) Kass Raftery (1995)), compare models, models assumed priori equally likely. using method \"PMP\", value winning criteria real number 0 1, since represents threshold value posterior probability complex model surpass selected appropriate model. default value case winning criteria 0.75, slightly favors model simplicity. value 0.75 give similar results two methods respective default values 2. method \"PMP\" chosen default method Bayes factor calculations can quite unstable. Let’s now use method, raise winning criteria 0.75 0.9 see results tournament change example, winner third final game still gplm0.","code":"> t_obj_known_c <- tournament(formula = Q ~ W , data = krokfors, c_param = 7.65) > t_obj_conservative <- tournament(t_obj$contestants, winning_criteria = 5) #>  #> Tournament winner: gplm0 > summary(t_obj_conservative) #>   round game model      lppd eff_num_param       WAIC Delta_WAIC winner #> 1     1    1  gplm 20.779382      6.870566 -27.817631  0.5570133  FALSE #> 2     1    1 gplm0 20.370954      6.740645 -27.260617         NA   TRUE #> 3     1    2   plm  5.584163      4.257375  -2.653577 -0.4065514  FALSE #> 4     1    2  plm0  5.628423      4.098359  -3.060129         NA   TRUE #> 5     2    3 gplm0 20.370954      6.740645 -27.260617 24.2004887   TRUE #> 6     2    3  plm0  5.628423      4.098359  -3.060129         NA  FALSE > t_obj_DIC <- tournament(t_obj$contestants, method = \"DIC\") #>  #> Tournament winner: gplm0 > summary(t_obj_DIC) #>   round game model     D_hat eff_num_param        DIC  Delta_DIC winner #> 1     1    1  gplm -42.77317      6.063058 -30.647051  0.8498163  FALSE #> 2     1    1 gplm0 -42.48795      6.345358 -29.797235         NA   TRUE #> 3     1    2   plm -11.34004      2.973852  -5.392337 -0.3058411  FALSE #> 4     1    2  plm0 -11.47124      2.886532  -5.698178         NA   TRUE #> 5     2    3 gplm0 -42.48795      6.345358 -29.797235 24.0990569   TRUE #> 6     2    3  plm0 -11.47124      2.886532  -5.698178         NA  FALSE > t_obj_prob <- tournament(t_obj$contestants, method = \"PMP\", winning_criteria = 0.9) #> ⚠ Warning: The Harmonic Mean Estimator (HME) is used to estimate the Bayes Factor for the posterior model probability (PMP), which is known to be unstable and potentially unreliable. We recommend using method \"WAIC\" (Widely Applicable Information Criterion) for model comparison instead. #> Tournament winner: gplm0 > summary(t_obj_prob)  #>   round game model     marg_lik    Post_prob winner #> 1     1    1  gplm 2.560009e+04 4.537982e-01  FALSE #> 2     1    1 gplm0 3.081285e+04 5.462018e-01   TRUE #> 3     1    2   plm 2.659317e+00 9.259920e-01   TRUE #> 4     1    2  plm0 2.125404e-01 7.400798e-02  FALSE #> 5     2    3 gplm0 3.081285e+04 9.999137e-01   TRUE #> 6     2    3   plm 2.659317e+00 8.629801e-05  FALSE"},{"path":"https://sor16.github.io/bdrc/dev/articles/tournament.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Tournament - Model comparison","text":"Hrafnkelsson, B., Sigurdarson, H., Rögnvaldsson, S., Jansson, . Ö., Vias, R. D., Gardarsson, S. M. (2022). Generalization power-law rating curve using hydrodynamic theory Bayesian hierarchical modeling, Environmetrics, 33(2):e2711. doi: https://doi.org/10.1002/env.2711 Jeffreys, H. (1961). Theory Probability, Third Edition. Oxford University Press. Kass, R., . Raftery, . (1995). Bayes Factors. Journal American Statistical Association, 90, 773-795. doi: https://doi.org/10.1080/01621459.1995.10476572 Spiegelhalter, D., Best, N., Carlin, B., Van Der Linde, . (2002). Bayesian measures model complexity fit. Journal Royal Statistical Society: Series B (Statistical Methodology) 64(4), 583–639. doi: https://doi.org/10.1111/1467-9868.00353 Watanabe, S. (2010). Asymptotic equivalence Bayes cross validation widely applicable information criterion singular learning theory. Journal Machine Learning Research, 11, 3571–3594.","code":""},{"path":"https://sor16.github.io/bdrc/dev/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Birgir Hrafnkelsson. Author, copyright holder. Solvi Rognvaldsson. Author, maintainer. Axel Orn Jansson. Author. Rafael Daníel Vias. Author.","code":""},{"path":"https://sor16.github.io/bdrc/dev/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Hrafnkelsson B, Rognvaldsson S, Jansson , Vias R (2024). bdrc: Bayesian Discharge Rating Curves. R package version 1.1.0.9000, https://sor16.github.io/bdrc.","code":"@Manual{,   title = {bdrc: Bayesian Discharge Rating Curves},   author = {Birgir Hrafnkelsson and Solvi Rognvaldsson and Axel Orn Jansson and Rafael Daníel Vias},   year = {2024},   note = {R package version 1.1.0.9000},   url = {https://sor16.github.io/bdrc}, }"},{"path":"https://sor16.github.io/bdrc/dev/index.html","id":"bdrc---bayesian-discharge-rating-curves-","dir":"","previous_headings":"","what":"bdrc - Bayesian Discharge Rating Curves","title":"Fit Bayesian Discharge Rating Curves","text":"software package fits discharge rating curve based power-law generalized power-law data paired water elevation discharge measurements given river using Bayesian hierarchical model described Hrafnkelsson et al. (2022). Four models implemented: plm0() - Power-law model constant error variance. Bayesian hierarchical implementation commonly used discharge rating curve model hydrological practice. plm() - Power-law model error variance varies water elevation. gplm0() - Generalized power-law model constant error variance. generalized power-law introduced Hrafnkelsson et al. (2022). gplm() - Generalized power-law model error variance varies water elevation. generalized power-law introduced Hrafnkelsson et al. (2022).","code":""},{"path":"https://sor16.github.io/bdrc/dev/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Fit Bayesian Discharge Rating Curves","text":"","code":"# Install release version from CRAN install.packages(\"bdrc\") # Install development version from GitHub devtools::install_github(\"sor16/bdrc\")"},{"path":"https://sor16.github.io/bdrc/dev/index.html","id":"getting-started","dir":"","previous_headings":"","what":"Getting started","title":"Fit Bayesian Discharge Rating Curves","text":"simple fit discharge rating curve bdrc package. need two mandatory input arguments: formula data. formula form y ~ x y discharge cubic meters per second (m3/^3/s) x water elevation m (important data correct units). input data data.frame must x y column names. example, use data Swedish gauging station Krokfors, one datasets come package. table, Q column denotes discharge W denotes water elevation: dig deeper functionality package different ways visualize discharge rating curve model data, recommend taking look two vignettes.","code":"gplm.fit <- gplm(Q ~ W, krokfors)"},{"path":"https://sor16.github.io/bdrc/dev/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Fit Bayesian Discharge Rating Curves","text":"Hrafnkelsson, B., Sigurdarson, H., Rögnvaldsson, S., Jansson, . Ö., Vias, R. D., Gardarsson, S. M. (2022). Generalization power-law rating curve using hydrodynamic theory Bayesian hierarchical modeling, Environmetrics, 33(2):e2711. doi: https://doi.org/10.1002/env.2711","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/autoplot.plm0.html","id":null,"dir":"Reference","previous_headings":"","what":"Autoplot method for discharge rating curves — autoplot.plm0","title":"Autoplot method for discharge rating curves — autoplot.plm0","text":"Visualize discharge rating curve model objects","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/autoplot.plm0.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Autoplot method for discharge rating curves — autoplot.plm0","text":"","code":"# S3 method for class 'plm0' autoplot(   object,   ...,   type = \"rating_curve\",   param = NULL,   transformed = FALSE,   title = NULL,   xlim = NULL,   ylim = NULL )  # S3 method for class 'plm' autoplot(   object,   ...,   type = \"rating_curve\",   param = NULL,   transformed = FALSE,   title = NULL,   xlim = NULL,   ylim = NULL )  # S3 method for class 'gplm0' autoplot(   object,   ...,   type = \"rating_curve\",   param = NULL,   transformed = FALSE,   title = NULL,   xlim = NULL,   ylim = NULL )  # S3 method for class 'gplm' autoplot(   object,   ...,   type = \"rating_curve\",   param = NULL,   transformed = FALSE,   title = NULL,   xlim = NULL,   ylim = NULL )"},{"path":"https://sor16.github.io/bdrc/dev/reference/autoplot.plm0.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Autoplot method for discharge rating curves — autoplot.plm0","text":"object object class \"plm0\",\"plm\",\"gplm0\" \"gplm\". ... plotting parameters (used function) type character denoting type plot drawn. Defaults \"rating_curve\". Possible types \"rating_curve\" plot rating curve. \"rating_curve_mean\" plot posterior mean rating curve. \"f\" plot power-law exponent. \"beta\" plot random effect power-law exponent. \"sigma_eps\" plot standard deviation data level. \"residuals\" plot log residuals. \"trace\" plot trace plots parameters given param. \"histogram\" plot histograms parameters given param. param character vector parameters plot. Defaults NULL used type \"trace\" \"histogram\". Allowed values parameters given model summary x well \"hyperparameters\" \"latent_parameters\" specific groups parameters. transformed logical value indicating whether quantity plotted transformed scale used Bayesian inference. Defaults FALSE. title character denoting title plot xlim numeric vector length 2, denoting limits x axis plot. Applicable types \"rating_curve\",\"rating_curve_mean\",\"f\",\"beta\",\"sigma_eps\",\"residuals\". ylim numeric vector length 2, denoting limits y axis plot. Applicable types \"rating_curve\",\"rating_curve_mean\",\"f\",\"beta\",\"sigma_eps\",\"residuals\".","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/autoplot.plm0.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Autoplot method for discharge rating curves — autoplot.plm0","text":"returns object class \"ggplot2\".","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/autoplot.plm0.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Autoplot method for discharge rating curves — autoplot.plm0","text":"autoplot(plm0): Autoplot method plm0 autoplot(plm): Autoplot method plm autoplot(gplm0): Autoplot method gplm0 autoplot(gplm): Autoplot method gplm","code":""},{"path":[]},{"path":"https://sor16.github.io/bdrc/dev/reference/autoplot.plm0.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Autoplot method for discharge rating curves — autoplot.plm0","text":"","code":"# \\donttest{ library(ggplot2) data(krokfors) set.seed(1) plm0.fit <- plm0(Q~W,krokfors,num_cores=2) #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 36.09%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). autoplot(plm0.fit)  autoplot(plm0.fit,transformed=TRUE)  autoplot(plm0.fit,type='histogram',param='c')  autoplot(plm0.fit,type='histogram',param='c',transformed=TRUE)  autoplot(plm0.fit,type='histogram',param='hyperparameters')  autoplot(plm0.fit,type='histogram',param='latent_parameters')  autoplot(plm0.fit,type='residuals')  autoplot(plm0.fit,type='f')  autoplot(plm0.fit,type='sigma_eps')  # }"},{"path":"https://sor16.github.io/bdrc/dev/reference/autoplot.tournament.html","id":null,"dir":"Reference","previous_headings":"","what":"Autoplot method for discharge rating curve tournament — autoplot.tournament","title":"Autoplot method for discharge rating curve tournament — autoplot.tournament","text":"Compare four discharge rating curves tournament object different ways","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/autoplot.tournament.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Autoplot method for discharge rating curve tournament — autoplot.tournament","text":"","code":"# S3 method for class 'tournament' autoplot(object, ..., type = \"boxplot\")"},{"path":"https://sor16.github.io/bdrc/dev/reference/autoplot.tournament.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Autoplot method for discharge rating curve tournament — autoplot.tournament","text":"object object class \"tournament\" ... plotting parameters (used function) type character denoting type plot drawn. Possible types \"boxplot\" create boxplot posterior log-likelihood values, deviance scale.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/autoplot.tournament.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Autoplot method for discharge rating curve tournament — autoplot.tournament","text":"returns object class \"ggplot2\".","code":""},{"path":[]},{"path":"https://sor16.github.io/bdrc/dev/reference/autoplot.tournament.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Autoplot method for discharge rating curve tournament — autoplot.tournament","text":"","code":"# \\donttest{ library(ggplot2) data(krokfors) set.seed(1) t_obj <- tournament(formula=Q~W,data=krokfors,num_cores=2) #> Running tournament [                                                ] 0% #>  #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 25.33%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). #>  #> - gplm finished  [============                                    ] 25% #>  #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 31.14%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). #>  #> - gplm0 finished [========================                        ] 50% #>  #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 25.66%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). #>  #> - plm finished   [====================================            ] 75% #>  #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 36.04%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). #>  #> - plm0 finished  [================================================] 100% #>  #> Tournament winner: gplm0 autoplot(t_obj)  # }"},{"path":"https://sor16.github.io/bdrc/dev/reference/evaluate_game.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare two models using a specified model-selection criteria — evaluate_game","title":"Compare two models using a specified model-selection criteria — evaluate_game","text":"evaluate_game uses Widely Applicable Information Criterion (WAIC), Deviance Information Criterion (DIC), posterior model probabilities (PMP), calculated Bayes factor, determine whether one model appropriate given data hand.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/evaluate_game.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare two models using a specified model-selection criteria — evaluate_game","text":"","code":"evaluate_game(m, method, winning_criteria)"},{"path":"https://sor16.github.io/bdrc/dev/reference/evaluate_game.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare two models using a specified model-selection criteria — evaluate_game","text":"m list two model objects fit dataset. allowed model objects \"gplm\", \"gplm0\", \"plm\" \"plm0\" method string specifying method used estimate predictive performance models. allowed methods \"WAIC\", \"DIC\" \"PMP\". winning_criteria numerical value sets threshold first model list must exceed declared appropriate model. value defaults 2 methods \"WAIC\" \"DIC\", defaults 0.75 method \"PMP\".","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/evaluate_game.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare two models using a specified model-selection criteria — evaluate_game","text":"data.frame summary results game","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/evaluate_game.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Compare two models using a specified model-selection criteria — evaluate_game","text":"Hrafnkelsson, B., Sigurdarson, H., Rögnvaldsson, S., Jansson, . Ö., Vias, R. D., Gardarsson, S. M. (2022). Generalization power-law rating curve using hydrodynamic theory Bayesian hierarchical modeling, Environmetrics, 33(2):e2711. doi: https://doi.org/10.1002/env.2711","code":""},{"path":[]},{"path":"https://sor16.github.io/bdrc/dev/reference/gather_draws.html","id":null,"dir":"Reference","previous_headings":"","what":"Gather MCMC chain draws to data.frame on a long format — gather_draws","title":"Gather MCMC chain draws to data.frame on a long format — gather_draws","text":"Useful convert MCMC chain draws particular parameters output model object long format data wrangling","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/gather_draws.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gather MCMC chain draws to data.frame on a long format — gather_draws","text":"","code":"gather_draws(mod, ..., transformed = F)"},{"path":"https://sor16.github.io/bdrc/dev/reference/gather_draws.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gather MCMC chain draws to data.frame on a long format — gather_draws","text":"mod object class \"plm0\",\"plm\",\"gplm0\" \"gplm\". ... number character vectors containing valid names parameters model \"rating_curve\" \"rating_curve_mean\". Also accepts \"latent_parameters\" \"hyperparameters\". transformed boolean value determining whether parameter represented transformed scale used sampling MCMC chain original scale. Defaults FALSE.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/gather_draws.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gather MCMC chain draws to data.frame on a long format — gather_draws","text":"Data frame columns chain iter param value","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/gather_draws.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Gather MCMC chain draws to data.frame on a long format — gather_draws","text":"Hrafnkelsson, B., Sigurdarson, H., Rögnvaldsson, S., Jansson, . Ö., Vias, R. D., Gardarsson, S. M. (2022). Generalization power-law rating curve using hydrodynamic theory Bayesian hierarchical modeling, Environmetrics, 33(2):e2711. doi: https://doi.org/10.1002/env.2711","code":""},{"path":[]},{"path":"https://sor16.github.io/bdrc/dev/reference/gather_draws.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Gather MCMC chain draws to data.frame on a long format — gather_draws","text":"","code":"# \\donttest{ data(krokfors) set.seed(1) plm0.fit <- plm0(formula=Q~W,data=krokfors,num_cores=2) #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 36.09%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). hyp_samples <- gather_draws(plm0.fit,'hyperparameters') head(hyp_samples) #>   chain iter name    value #> 1     1    1    c 7.693275 #> 2     1    2    c 7.708797 #> 3     1    3    c 7.704167 #> 4     1    4    c 7.666575 #> 5     1    5    c 7.658464 #> 6     1    6    c 7.709366 rating_curve_samples <- gather_draws(plm0.fit,'rating_curve','rating_curve_mean') head(rating_curve_samples) #>   chain iter        h         name        value #> 1     1    1 7.673811 rating_curve 0.000000e+00 #> 2     1    2 7.673811 rating_curve 0.000000e+00 #> 3     1    3 7.673811 rating_curve 0.000000e+00 #> 4     1    4 7.673811 rating_curve 1.094840e-06 #> 5     1    5 7.673811 rating_curve 6.537613e-06 #> 6     1    6 7.673811 rating_curve 0.000000e+00 # }"},{"path":"https://sor16.github.io/bdrc/dev/reference/get_report.html","id":null,"dir":"Reference","previous_headings":"","what":"Report for a discharge rating curve or tournament — get_report","title":"Report for a discharge rating curve or tournament — get_report","text":"Save pdf file report discharge rating curve object tournament.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/get_report.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Report for a discharge rating curve or tournament — get_report","text":"","code":"get_report(x, path = NULL, type = 1, ...)  # S3 method for class 'plm0' get_report(x, path = NULL, type = 1, ...)  # S3 method for class 'plm' get_report(x, path = NULL, type = 1, ...)  # S3 method for class 'gplm0' get_report(x, path = NULL, type = 1, ...)  # S3 method for class 'gplm' get_report(x, path = NULL, type = 1, ...)  # S3 method for class 'tournament' get_report(x, path = NULL, type = 1, ...)"},{"path":"https://sor16.github.io/bdrc/dev/reference/get_report.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Report for a discharge rating curve or tournament — get_report","text":"x object class \"tournament\", \"plm0\", \"plm\", \"gplm0\" \"gplm\". path file path pdf file report saved. NULL, current working directory used. type integer denoting type report produced. Defaults type 1. type 1 permissible object class \"plm0\", \"plm\", \"gplm0\" \"gplm\". Possible types 1 - produces report displaying results model (winning model tournament provided). first page contains panel four plots summary posterior distributions parameters. second page tabular prediction discharge equally spaced grid stages displayed. prediction table can span multiple pages. 2 - produces ten page report permissible objects class \"tournament\". first four pages contain panel four plots summary posterior distributions parameters four models tournament, fifth page shows model comparison plots tables, sixth page convergence diagnostics plots, final four pages shows histograms parameters four models. ... arguments passed methods (currently unused).","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/get_report.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Report for a discharge rating curve or tournament — get_report","text":"return value, called side effects","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/get_report.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Report for a discharge rating curve or tournament — get_report","text":"function can used interactive R session asks permission user write file system.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/get_report.html","id":"methods-by-class-","dir":"Reference","previous_headings":"","what":"Methods (by class)","title":"Report for a discharge rating curve or tournament — get_report","text":"get_report(plm0): Get report plm0 model object get_report(plm): Get report plm model object get_report(gplm0): Get report gplm0 model object get_report(gplm): Get report gplm get_report(tournament): Get report discharge rating curve tournament","code":""},{"path":[]},{"path":"https://sor16.github.io/bdrc/dev/reference/get_report.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Report for a discharge rating curve or tournament — get_report","text":"","code":"# \\donttest{ data(krokfors) set.seed(1) plm0.fit <- plm0(formula=Q~W,data=krokfors,num_cores=2) #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 36.09%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). # } if (FALSE) { # \\dontrun{ get_report(plm0.fit) } # }"},{"path":"https://sor16.github.io/bdrc/dev/reference/get_report_pages.html","id":null,"dir":"Reference","previous_headings":"","what":"Report pages for a discharge rating curve or tournament — get_report_pages","title":"Report pages for a discharge rating curve or tournament — get_report_pages","text":"Get list pages report discharge rating curve model tournament","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/get_report_pages.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Report pages for a discharge rating curve or tournament — get_report_pages","text":"","code":"get_report_pages(x, type = 1, ...)  # S3 method for class 'plm0' get_report_pages(x, type = 1, ...)  # S3 method for class 'plm' get_report_pages(x, type = 1, ...)  # S3 method for class 'gplm0' get_report_pages(x, type = 1, ...)  # S3 method for class 'gplm' get_report_pages(x, type = 1, ...)  # S3 method for class 'tournament' get_report_pages(x, type = 1, ...)"},{"path":"https://sor16.github.io/bdrc/dev/reference/get_report_pages.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Report pages for a discharge rating curve or tournament — get_report_pages","text":"x object class \"tournament\", \"plm0\", \"plm\", \"gplm0\" \"gplm\". type integer denoting type report produced. Defaults type 1. Possible types 1 - produces report displaying results model (winning model tournament provided). first page contains panel four plots summary posterior distributions parameters. second page tabular prediction discharge equally spaced grid stages displayed. prediction table can span multiple pages. 2 - produces ten page report permissible objects class \"tournament\". first four pages contain panel four plots summary posterior distributions parameters four models tournament, fifth page shows model comparison plots tables, sixth page convergence diagnostics plots, final four pages shows histograms parameters four models. ... arguments passed methods (currently unused).","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/get_report_pages.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Report pages for a discharge rating curve or tournament — get_report_pages","text":"list objects type \"grob\" correspond pages rating curve report.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/get_report_pages.html","id":"methods-by-class-","dir":"Reference","previous_headings":"","what":"Methods (by class)","title":"Report pages for a discharge rating curve or tournament — get_report_pages","text":"get_report_pages(plm0): Get report pages plm0 model object get_report_pages(plm): Get report pages plm model object get_report_pages(gplm0): Get report pages gplm0 model object get_report_pages(gplm): Get report pages gplm model object get_report_pages(tournament): Get report pages discharge rating curve tournament model object","code":""},{"path":[]},{"path":"https://sor16.github.io/bdrc/dev/reference/get_report_pages.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Report pages for a discharge rating curve or tournament — get_report_pages","text":"","code":"# \\donttest{ data(krokfors) set.seed(1) plm0.fit <- plm0(formula=Q~W,data=krokfors,num_cores=2) #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 36.09%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). plm0_pages <- get_report_pages(plm0.fit) # }"},{"path":"https://sor16.github.io/bdrc/dev/reference/gplm.html","id":null,"dir":"Reference","previous_headings":"","what":"Generalized power-law model with variance that varies with stage. — gplm","title":"Generalized power-law model with variance that varies with stage. — gplm","text":"gplm used fit discharge rating curve paired measurements stage discharge using generalized power-law model variance varies stage described Hrafnkelsson et al. (2022).  See \"Details\" elaborate description model.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/gplm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generalized power-law model with variance that varies with stage. — gplm","text":"","code":"gplm(   formula,   data,   c_param = NULL,   h_max = NULL,   parallel = TRUE,   num_cores = NULL,   forcepoint = rep(FALSE, nrow(data)),   verbose = TRUE )"},{"path":"https://sor16.github.io/bdrc/dev/reference/gplm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generalized power-law model with variance that varies with stage. — gplm","text":"formula object class \"formula\", discharge column name response stage column name covariate, .e. form y~x y discharge m\\(^3/\\)s x stage m (important data correct units). data data.frame containing variables specified formula. c_param largest stage value zero discharge. NULL, treated unknown model inferred data. h_max maximum stage rating curve extrapolate . NULL, maximum stage value data selected upper bound. parallel logical value indicating whether run MCMC parallel . Defaults TRUE. num_cores integer 1 4 (number MCMC chains) indicating many cores use. used parallel=TRUE. NULL, number cores available device detected automatically. forcepoint logical vector length number rows data. element index \\(\\) TRUE indicates rating curve forced \\(\\)-th measurement. Use care, strongly influence resulting rating curve. verbose logical value indicating whether print progress diagnostic information. `TRUE`, function print messages runs. `FALSE`, function run silently. Default `TRUE`.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/gplm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generalized power-law model with variance that varies with stage. — gplm","text":"gplm returns object class \"gplm\". object class \"gplm\" list containing following components: rating_curve data frame 2.5%, 50% 97.5% percentiles posterior predictive distribution rating curve. rating_curve_mean data frame 2.5%, 50% 97.5% percentiles posterior distribution mean rating curve. param_summary data frame 2.5%, 50% 97.5% percentiles posterior distribution latent- hyperparameters. Additionally contains columns r_hat effective number samples parameter defined Gelman et al. (2013). f_summary data frame 2.5%, 50% 97.5% percentiles posterior distribution \\(f(h)\\). beta_summary data frame 2.5%, 50% 97.5% percentiles posterior distribution \\(\\beta(h)\\). sigma_eps_summary data frame 2.5%, 50% 97.5% percentiles posterior distribution \\(\\sigma_\\varepsilon(h)\\). posterior_log_likelihood_summary data frame 2.5%, 50% 97.5% percentiles posterior log-likelihood values. rating_curve_posterior matrix containing full thinned posterior samples posterior predictive distribution rating curve excluding burn-samples. rating_curve_mean_posterior matrix containing full thinned posterior samples posterior distribution mean rating curve excluding burn-samples. a_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\) excluding burn-samples. b_posterior numeric vector containing full thinned posterior samples posterior distribution \\(b\\) excluding burn-samples. c_posterior numeric vector containing full thinned posterior samples posterior distribution \\(c\\) excluding burn-samples. sigma_beta_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\sigma_\\beta\\) excluding burn-samples. phi_beta_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\phi_\\beta\\) excluding burn-samples. sigma_eta_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\sigma_\\eta\\) excluding burn-samples. eta_1_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\eta_1\\) excluding burn-samples. eta_2_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\eta_2\\) excluding burn-samples. eta_3_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\eta_3\\) excluding burn-samples. eta_4_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\eta_4\\) excluding burn-samples. eta_5_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\eta_5\\) excluding burn-samples. eta_6_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\eta_6\\) excluding burn-samples. f_posterior numeric vector containing full thinned posterior samples posterior distribution \\(f(h)\\) excluding burn-samples. beta_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\beta(h)\\) excluding burn-samples. sigma_eps_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\sigma_\\varepsilon(h)\\) excluding burn-samples. posterior_log_likelihood numeric vector containing full thinned posterior log-likelihood values, excluding burn-samples. D_hat statistic defined -2 times log-likelihood evaluated median value parameters. effective_num_param_DIC effective number parameters, calculated median(-2*posterior_log_likelihood) minus D_hat. DIC Deviance Information Criterion model, calculated D_hat plus 2*effective_num_parameters_DIC. lppd log pointwise predictive density observed data model WAIC Widely Applicable Information Criterion model, defined -2*( lppd - effective_num_param_WAIC ). WAIC_i pointwise WAIC values, WAIC := sum(WAIC_i). effective_num_param_WAIC effective number parameters, calculated summing posterior variance log predictive density data point. autocorrelation data frame autocorrelation parameter different lags. acceptance_rate proportion accepted samples thinned MCMC chain (excluding burn-). formula object type \"formula\" provided user. data data provided user, ordered stage. run_info information input arguments specific parameters used MCMC chain.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/gplm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generalized power-law model with variance that varies with stage. — gplm","text":"generalized power-law model form $$Q=(h-c)^{f(h)}$$ \\(Q\\) discharge, \\(h\\) stage, \\(\\) \\(c\\) unknown constants \\(f\\) function \\(h\\), referred generalized power-law exponent. generalized power-law model inferred using Bayesian hierarchical model. function \\(f\\) modeled latent level fixed constant \\(b\\) plus continuous stochastic process, \\(\\beta(h)\\), assumed twice differentiable. model logarithmic scale $$\\log(Q_i) = \\log() + (b + \\beta(h_i)) \\log(h_i - c) + \\varepsilon_i,     = 1,...,n$$ \\(\\varepsilon_i\\) follows normal distribution mean zero variance \\(\\sigma_\\varepsilon(h_i)^2\\) varies stage. stochastic process \\(\\beta(h)\\) assumed priori Gaussian process governed Matern covariance function smoothness parameter \\(\\nu = 2.5\\). error variance, \\(\\sigma_\\varepsilon^2(h)\\), log-discharge data  modeled exponential B-spline curve, , linear combination six B-spline basis functions defined range stage observations. efficient posterior simulation achieved sampling joint posterior density hyperparameters model, sampling density latent parameters conditional hyperparameters. Bayesian inference based posterior density summary statistics posterior mean 95% posterior intervals based posterior density. Analytical formulas summary statistics intractable cases thus computed generating samples posterior density using Markov chain Monte Carlo simulation.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/gplm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Generalized power-law model with variance that varies with stage. — gplm","text":"Gelman, ., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari, ., Rubin, D. B. (2013). Bayesian Data Analysis, Third Edition. Chapman & Hall/CRC Texts Statistical Science. Taylor & Francis. doi: https://doi.org/10.1201/b16018 Hrafnkelsson, B., Sigurdarson, H., Rögnvaldsson, S., Jansson, . Ö., Vias, R. D., Gardarsson, S. M. (2022). Generalization power-law rating curve using hydrodynamic theory Bayesian hierarchical modeling, Environmetrics, 33(2):e2711. doi: https://doi.org/10.1002/env.2711 Spiegelhalter, D., Best, N., Carlin, B., Van Der Linde, . (2002). Bayesian measures model complexity fit. Journal Royal Statistical Society: Series B (Statistical Methodology) 64(4), 583–639. doi: https://doi.org/10.1111/1467-9868.00353 Watanabe, S. (2010). Asymptotic equivalence Bayes cross validation widely applicable information criterion singular learning theory. J. Mach. Learn. Res. 11, 3571–3594.","code":""},{"path":[]},{"path":"https://sor16.github.io/bdrc/dev/reference/gplm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generalized power-law model with variance that varies with stage. — gplm","text":"","code":"# \\donttest{ data(norn) set.seed(1) gplm.fit <- gplm(formula=Q~W,data=norn,num_cores=2) #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 22.40%. #> ⚠ Warning: Some chains are not mixing well. Parameters with Rhat > 1.1: #>   - sigma_eta: Rhat = 1.240 #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). #> ℹ Try re-running the model after inspecting the trace plots, convergence diagnostics plots, and reviewing the data for potential issues. summary(gplm.fit) #>  #> Formula:  #>  Q ~ W #> Latent parameters: #>   lower-2.5% median-50% upper-97.5% #> a 13.25      24.51      32.40       #> b  1.83       1.84       1.84       #>  #> Hyperparameters: #>            lower-2.5% median-50% upper-97.5% #> c          396.4175   396.668    396.811     #> sigma_beta   0.1645     0.336      0.818     #> phi_beta     1.3160     2.951      6.989     #> sigma_eta    0.0102     0.404      0.889     #> eta_1       -6.1617    -5.436     -4.429     #> eta_2       -7.6291    -5.977     -4.398     #> eta_3       -9.1231    -6.988     -4.636     #> eta_4      -10.4709    -7.952     -4.365     #> eta_5      -11.5244    -8.656     -4.129     #> eta_6      -12.4633    -9.112     -4.072     #>  #> WAIC: -139.6985 # }"},{"path":"https://sor16.github.io/bdrc/dev/reference/gplm0.html","id":null,"dir":"Reference","previous_headings":"","what":"Generalized power-law model with a constant variance — gplm0","title":"Generalized power-law model with a constant variance — gplm0","text":"gplm0 used fit discharge rating curve paired measurements stage discharge using generalized power-law model constant variance described Hrafnkelsson et al. (2022). See \"Details\" elaborate description model.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/gplm0.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generalized power-law model with a constant variance — gplm0","text":"","code":"gplm0(   formula,   data,   c_param = NULL,   h_max = NULL,   parallel = TRUE,   num_cores = NULL,   forcepoint = rep(FALSE, nrow(data)),   verbose = TRUE )"},{"path":"https://sor16.github.io/bdrc/dev/reference/gplm0.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generalized power-law model with a constant variance — gplm0","text":"formula object class \"formula\", discharge column name response stage column name covariate, .e. form y~x y discharge m\\(^3/\\)s x stage m (important data correct units). data data.frame containing variables specified formula. c_param largest stage value zero discharge. NULL, treated unknown model inferred data. h_max maximum stage rating curve extrapolate . NULL, maximum stage value data selected upper bound. parallel logical value indicating whether run MCMC parallel . Defaults TRUE. num_cores integer 1 4 (number MCMC chains) indicating many cores use. used parallel=TRUE. NULL, number cores available device detected automatically. forcepoint logical vector length number rows data. element index \\(\\) TRUE indicates rating curve forced \\(\\)-th measurement. Use care, strongly influence resulting rating curve. verbose logical value indicating whether print progress diagnostic information. `TRUE`, function print messages runs. `FALSE`, function run silently. Default `TRUE`.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/gplm0.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generalized power-law model with a constant variance — gplm0","text":"gplm0 returns object class \"gplm0\". object class \"gplm0\" list containing following components: rating_curve data frame 2.5%, 50% 97.5% percentiles posterior predictive distribution rating curve. rating_curve_mean data frame 2.5%, 50% 97.5% percentiles posterior distribution mean rating curve. param_summary data frame 2.5%, 50% 97.5% percentiles posterior distribution latent- hyperparameters. Additionally contains columns r_hat effective number samples parameter defined Gelman et al. (2013). beta_summary data frame 2.5%, 50% 97.5% percentiles posterior distribution \\(\\beta\\). posterior_log_likelihood_summary data frame 2.5%, 50% 97.5% percentiles posterior log-likelihood values. rating_curve_posterior matrix containing full thinned posterior samples posterior predictive distribution rating curve (excluding burn-). rating_curve_mean_posterior matrix containing full thinned posterior samples posterior distribution mean rating curve (excluding burn-). a_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\). b_posterior numeric vector containing full thinned posterior samples posterior distribution \\(b\\). c_posterior numeric vector containing full thinned posterior samples posterior distribution \\(c\\). sigma_eps_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\sigma_{\\varepsilon}\\). sigma_beta_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\sigma_{\\beta}\\). phi_beta_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\phi_{\\beta}\\). sigma_eta_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\sigma_{\\eta}\\). beta_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\beta\\). posterior_log_likelihood numeric vector containing full thinned posterior log-likelihood values, excluding burn-samples. D_hat statistic defined -2 times log-likelihood evaluated median value parameters. effective_num_param_DIC effective number parameters, calculated median(-2*posterior_log_likelihood) minus D_hat. DIC Deviance Information Criterion model, calculated D_hat plus 2*effective_num_parameters_DIC. lppd log pointwise predictive density observed data model WAIC Widely Applicable Information Criterion model, defined -2*( lppd - effective_num_param_WAIC ). WAIC_i pointwise WAIC values, WAIC := sum(WAIC_i). effective_num_param_WAIC effective number parameters, calculated summing posterior variance log predictive density data point. autocorrelation data frame autocorrelation parameter different lags. acceptance_rate proportion accepted samples thinned MCMC chain (excluding burn-). formula object type \"formula\" provided user. data data provided user, ordered stage. run_info information input arguments specific parameters used MCMC chain.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/gplm0.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generalized power-law model with a constant variance — gplm0","text":"generalized power-law model form $$Q=(h-c)^{f(h)}$$ \\(Q\\) discharge, \\(h\\) stage, \\(\\) \\(c\\) unknown constants \\(f\\) function \\(h\\) referred generalized power-law exponent. generalized power-law model inferred using Bayesian hierarchical model. function \\(f\\) modeled latent level fixed constant $b$ plus continuous stochastic process,\\(\\beta(h)\\), assumed twice differentiable. model logarithmic scale $$\\log(Q_i) = \\log() + (b + \\beta(h_i)) \\log(h_i - c) + \\varepsilon,     = 1,...,n$$ \\(\\varepsilon\\) follows normal distribution mean zero variance \\(\\sigma_\\varepsilon^2\\), independent stage. stochastic process \\(\\beta(h)\\) assumed priori Gaussian process governed Matern covariance function smoothness parameter \\(\\nu = 2.5\\). efficient posterior simulation achieved sampling joint posterior density hyperparameters model, sampling density latent parameters conditional hyperparameters. Bayesian inference based posterior density summary statistics posterior mean 95% posterior intervals based posterior density. Analytical formulas summary statistics intractable cases thus computed generating samples posterior density using Markov chain Monte Carlo simulation.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/gplm0.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Generalized power-law model with a constant variance — gplm0","text":"Gelman, ., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari, ., Rubin, D. B. (2013). Bayesian Data Analysis, Third Edition. Chapman & Hall/CRC Texts Statistical Science. Taylor & Francis. doi: https://doi.org/10.1201/b16018 Hrafnkelsson, B., Sigurdarson, H., Rögnvaldsson, S., Jansson, . Ö., Vias, R. D., Gardarsson, S. M. (2022). Generalization power-law rating curve using hydrodynamic theory Bayesian hierarchical modeling, Environmetrics, 33(2):e2711. doi: https://doi.org/10.1002/env.2711 Spiegelhalter, D., Best, N., Carlin, B., Van Der Linde, . (2002). Bayesian measures model complexity fit. Journal Royal Statistical Society: Series B (Statistical Methodology) 64(4), 583–639. doi: https://doi.org/10.1111/1467-9868.00353 Watanabe, S. (2010). Asymptotic equivalence Bayes cross validation widely applicable information criterion singular learning theory. J. Mach. Learn. Res. 11, 3571–3594.","code":""},{"path":[]},{"path":"https://sor16.github.io/bdrc/dev/reference/gplm0.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generalized power-law model with a constant variance — gplm0","text":"","code":"# \\donttest{ data(krokfors) set.seed(1) gplm0.fit <- gplm0(formula=Q~W,data=krokfors,num_cores=2) #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 31.64%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). summary(gplm0.fit) #>  #> Formula:  #>  Q ~ W #> Latent parameters: #>   lower-2.5% median-50% upper-97.5% #> a 1.52       1.95       2.24        #> b 1.83       1.84       1.84        #>  #> Hyperparameters: #>            lower-2.5% median-50% upper-97.5% #> c          7.7158     7.810      7.855       #> sigma_eps  0.0915     0.119      0.163       #> sigma_beta 0.6492     0.836      1.127       #> phi_beta   0.5724     1.207      2.965       #>  #> WAIC: -27.34769 # }"},{"path":"https://sor16.github.io/bdrc/dev/reference/jokdal.html","id":null,"dir":"Reference","previous_headings":"","what":"Jokulsa a Dal gauging station in Iceland — jokdal","title":"Jokulsa a Dal gauging station in Iceland — jokdal","text":"Data discharge stage Jokulsa Dal gauging station Iceland","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/jokdal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Jokulsa a Dal gauging station in Iceland — jokdal","text":"","code":"jokdal"},{"path":"https://sor16.github.io/bdrc/dev/reference/jokdal.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Jokulsa a Dal gauging station in Iceland — jokdal","text":"data frame columns: W Measurements water stage meters Q Measurements water discharge cubic meters per second","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/jokdal.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Jokulsa a Dal gauging station in Iceland — jokdal","text":"Icelandic Meteorological Office, Landsvirkjun - National Power Company Iceland, Icelandic Road Coastal Administration.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/jokfjoll.html","id":null,"dir":"Reference","previous_headings":"","what":"Jokulsa a Fjollum gauging station in Iceland — jokfjoll","title":"Jokulsa a Fjollum gauging station in Iceland — jokfjoll","text":"Data discharge stage Jokulsa Fjollum gauging station Iceland","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/jokfjoll.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Jokulsa a Fjollum gauging station in Iceland — jokfjoll","text":"","code":"jokfjoll"},{"path":"https://sor16.github.io/bdrc/dev/reference/jokfjoll.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Jokulsa a Fjollum gauging station in Iceland — jokfjoll","text":"data frame columns: W Measurements water stage meters Q Measurements water discharge cubic meters per second","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/jokfjoll.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Jokulsa a Fjollum gauging station in Iceland — jokfjoll","text":"Icelandic Meteorological Office, Landsvirkjun - National Power Company Iceland, Icelandic Road Coastal Administration.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/kallstorp.html","id":null,"dir":"Reference","previous_headings":"","what":"Kallstorp gauging station in Sweden — kallstorp","title":"Kallstorp gauging station in Sweden — kallstorp","text":"Data discharge stage Kallstorp gauging station Sweden","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/kallstorp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Kallstorp gauging station in Sweden — kallstorp","text":"","code":"kallstorp"},{"path":"https://sor16.github.io/bdrc/dev/reference/kallstorp.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Kallstorp gauging station in Sweden — kallstorp","text":"data frame columns: W Measurements water stage meters Q Measurements water discharge cubic meters per second","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/kallstorp.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Kallstorp gauging station in Sweden — kallstorp","text":"Swedish Meteorological Hydrological Institute.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/krokfors.html","id":null,"dir":"Reference","previous_headings":"","what":"Krokfors gauging station in Sweden — krokfors","title":"Krokfors gauging station in Sweden — krokfors","text":"Data discharge stage Krokfors gauging station Sweden.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/krokfors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Krokfors gauging station in Sweden — krokfors","text":"","code":"krokfors"},{"path":"https://sor16.github.io/bdrc/dev/reference/krokfors.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Krokfors gauging station in Sweden — krokfors","text":"data frame columns: W Measurements water stage meters Q Measurements water discharge cubic meters per second","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/krokfors.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Krokfors gauging station in Sweden — krokfors","text":"Swedish Meteorological Hydrological Institute.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/melby.html","id":null,"dir":"Reference","previous_headings":"","what":"Melby gauging station in Sweden — melby","title":"Melby gauging station in Sweden — melby","text":"Data discharge stage Melby gauging station Sweden","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/melby.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Melby gauging station in Sweden — melby","text":"","code":"melby"},{"path":"https://sor16.github.io/bdrc/dev/reference/melby.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Melby gauging station in Sweden — melby","text":"data frame columns: W Measurements water stage meters Q Measurements water discharge cubic meters per second","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/melby.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Melby gauging station in Sweden — melby","text":"Swedish Meteorological Hydrological Institute.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/nordura.html","id":null,"dir":"Reference","previous_headings":"","what":"Nordura gauging station in Iceland — nordura","title":"Nordura gauging station in Iceland — nordura","text":"Data discharge stage Nordura gauging station Iceland","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/nordura.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Nordura gauging station in Iceland — nordura","text":"","code":"nordura"},{"path":"https://sor16.github.io/bdrc/dev/reference/nordura.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Nordura gauging station in Iceland — nordura","text":"data frame columns: W Measurements water stage meters Q Measurements water discharge cubic meters per second","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/nordura.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Nordura gauging station in Iceland — nordura","text":"Icelandic Meteorological Office, Landsvirkjun - National Power Company Iceland, Icelandic Road Coastal Administration.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/norn.html","id":null,"dir":"Reference","previous_headings":"","what":"Norn gauging station in Sweden — norn","title":"Norn gauging station in Sweden — norn","text":"Data discharge stage Norn gauging station Sweden.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/norn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Norn gauging station in Sweden — norn","text":"","code":"norn"},{"path":"https://sor16.github.io/bdrc/dev/reference/norn.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Norn gauging station in Sweden — norn","text":"data frame columns: W Measurements water stage meters Q Measurements water discharge cubic meters per second","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/norn.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Norn gauging station in Sweden — norn","text":"Swedish Meteorological Hydrological Institute.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/plm.html","id":null,"dir":"Reference","previous_headings":"","what":"Power-law model with variance that varies with stage. — plm","title":"Power-law model with variance that varies with stage. — plm","text":"plm used fit discharge rating curve paired measurements stage discharge using power-law model variance varies stage described Hrafnkelsson et al. (2022). See \"Details\" elaborate description model.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/plm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Power-law model with variance that varies with stage. — plm","text":"","code":"plm(   formula,   data,   c_param = NULL,   h_max = NULL,   parallel = TRUE,   num_cores = NULL,   forcepoint = rep(FALSE, nrow(data)),   verbose = TRUE )"},{"path":"https://sor16.github.io/bdrc/dev/reference/plm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Power-law model with variance that varies with stage. — plm","text":"formula object class \"formula\", discharge column name response stage column name covariate, .e. form y~x y discharge m\\(^3/\\)s x stage m (important data correct units). data data.frame containing variables specified formula. c_param largest stage value zero discharge. NULL, treated unknown model inferred data. h_max maximum stage rating curve extrapolate . NULL, maximum stage value data selected upper bound. parallel logical value indicating whether run MCMC parallel . Defaults TRUE. num_cores integer 1 4 (number MCMC chains) indicating many cores use. used parallel=TRUE. NULL, number cores available device detected automatically. forcepoint logical vector length number rows data. element index \\(\\) TRUE indicates rating curve forced \\(\\)-th measurement. Use care, strongly influence resulting rating curve. verbose logical value indicating whether print progress diagnostic information. `TRUE`, function print messages runs. `FALSE`, function run silently. Default `TRUE`.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/plm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Power-law model with variance that varies with stage. — plm","text":"plm returns object class \"plm\". object class \"plm\" list containing following components: rating_curve data frame 2.5%, 50% 97.5% percentiles posterior predictive distribution rating curve. rating_curve_mean data frame 2.5%, 50% 97.5% percentiles posterior distribution mean rating curve. Additionally contains columns r_hat effective number samples parameter defined Gelman et al. (2013). param_summary data frame 2.5%, 50% 97.5% percentiles posterior distribution latent- hyperparameters. sigma_eps_summary data frame 2.5%, 50% 97.5% percentiles posterior \\(\\sigma_{\\varepsilon}\\). posterior_log_likelihood_summary data frame 2.5%, 50% 97.5% percentiles posterior log-likelihood values. rating_curve_posterior matrix containing full thinned posterior samples posterior predictive distribution rating curve (excluding burn-). rating_curve_mean_posterior matrix containing full thinned posterior samples posterior distribution mean rating curve (excluding burn-). a_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\). b_posterior numeric vector containing full thinned posterior samples posterior distribution \\(b\\). c_posterior numeric vector containing full thinned posterior samples posterior distribution \\(c\\). sigma_eps_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\sigma_{\\varepsilon}\\). eta_1_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\eta_1\\). eta_2_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\eta_2\\). eta_3_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\eta_3\\). eta_4_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\eta_4\\). eta_5_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\eta_5\\). eta_6_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\eta_6\\). posterior_log_likelihood numeric vector containing full thinned posterior log-likelihood values, excluding burn-samples. D_hat statistic defined -2 times log-likelihood evaluated median value parameters. effective_num_param_DIC effective number parameters, calculated median(-2*posterior_log_likelihood) minus D_hat. DIC Deviance Information Criterion model, calculated D_hat plus 2*effective_num_parameters_DIC. lppd log pointwise predictive density observed data model WAIC Widely Applicable Information Criterion model, defined -2*( lppd - effective_num_param_WAIC ). WAIC_i pointwise WAIC values, WAIC := sum(WAIC_i). effective_num_param_WAIC effective number parameters, calculated summing posterior variance log predictive density data point. autocorrelation data frame autocorrelation parameter different lags. acceptance_rate proportion accepted samples thinned MCMC chain (excluding burn-). formula object type \"formula\" provided user. data data provided user, ordered stage. run_info information input arguments specific parameters used MCMC chain.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/plm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Power-law model with variance that varies with stage. — plm","text":"power-law model, commonly used hydraulic practice, form $$Q=(h-c)^{b}$$ \\(Q\\) discharge, \\(h\\) stage \\(\\), \\(b\\) \\(c\\) unknown constants. power-law model inferred using Bayesian hierarchical model. model logarithmic scale $$\\log(Q_i) = \\log() + b \\log(h_i - c) + \\varepsilon_i,     = 1,...,n$$ \\(\\varepsilon_i\\) follows normal distribution mean zero variance \\(\\sigma_\\varepsilon(h_i)^2\\) varies stage. error variance, \\(\\sigma_\\varepsilon^2(h)\\), log-discharge data modeled exponential B-spline curve, , linear combination six B-spline basis functions defined range stage observations. efficient posterior simulation achieved sampling joint posterior density hyperparameters model, sampling density latent parameters conditional hyperparameters. Bayesian inference based posterior density summary statistics posterior mean 95% posterior intervals based posterior density. Analytical formulas summary statistics intractable cases thus computed generating samples posterior density using Markov chain Monte Carlo simulation.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/plm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Power-law model with variance that varies with stage. — plm","text":"Gelman, ., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari, ., Rubin, D. B. (2013). Bayesian Data Analysis, Third Edition. Chapman & Hall/CRC Texts Statistical Science. Taylor & Francis. doi: https://doi.org/10.1201/b16018 Hrafnkelsson, B., Sigurdarson, H., Rögnvaldsson, S., Jansson, . Ö., Vias, R. D., Gardarsson, S. M. (2022). Generalization power-law rating curve using hydrodynamic theory Bayesian hierarchical modeling, Environmetrics, 33(2):e2711. doi: https://doi.org/10.1002/env.2711 Spiegelhalter, D., Best, N., Carlin, B., Van Der Linde, . (2002). Bayesian measures model complexity fit. Journal Royal Statistical Society: Series B (Statistical Methodology) 64(4), 583–639. doi: https://doi.org/10.1111/1467-9868.00353 Watanabe, S. (2010). Asymptotic equivalence Bayes cross validation widely applicable information criterion singular learning theory. J. Mach. Learn. Res. 11, 3571–3594.","code":""},{"path":[]},{"path":"https://sor16.github.io/bdrc/dev/reference/plm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Power-law model with variance that varies with stage. — plm","text":"","code":"# \\donttest{ data(spanga) set.seed(1) plm.fit <- plm(formula=Q~W,data=spanga,num_cores=2) #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 23.26%. #> ⚠ Warning: Some chains are not mixing well. Parameters with Rhat > 1.1: #>   - sigma_eta: Rhat = 1.185 #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). #> ℹ Try re-running the model after inspecting the trace plots, convergence diagnostics plots, and reviewing the data for potential issues. summary(plm.fit) #>  #> Formula:  #>  Q ~ W #> Latent parameters: #>   lower-2.5% median-50% upper-97.5% #> a 11.12      12.55      13.9        #> b  1.91       2.04       2.2        #>  #> Hyperparameters: #>           lower-2.5% median-50% upper-97.5% #> c           9.4020    9.453      9.50       #> sigma_eta   0.0125    0.349      0.87       #> eta_1      -5.5784   -4.828     -3.77       #> eta_2      -7.6875   -5.949     -4.21       #> eta_3      -9.0695   -6.918     -4.17       #> eta_4      -9.9277   -7.344     -4.16       #> eta_5     -10.6150   -7.595     -3.98       #> eta_6     -11.0295   -7.576     -3.62       #>  #> WAIC: -76.82704 # }"},{"path":"https://sor16.github.io/bdrc/dev/reference/plm0.html","id":null,"dir":"Reference","previous_headings":"","what":"Power-law model with a constant variance — plm0","title":"Power-law model with a constant variance — plm0","text":"plm0 used fit discharge rating curve paired measurements stage discharge using power-law model constant variance described Hrafnkelsson et al. (2022). See \"Details\" elaborate description model.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/plm0.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Power-law model with a constant variance — plm0","text":"","code":"plm0(   formula,   data,   c_param = NULL,   h_max = NULL,   parallel = TRUE,   num_cores = NULL,   forcepoint = rep(FALSE, nrow(data)),   verbose = TRUE )"},{"path":"https://sor16.github.io/bdrc/dev/reference/plm0.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Power-law model with a constant variance — plm0","text":"formula object class \"formula\", discharge column name response stage column name covariate, .e. form y~x y discharge m\\(^3/\\)s x stage m (important data correct units). data data.frame containing variables specified formula. c_param largest stage value zero discharge. NULL, treated unknown model inferred data. h_max maximum stage rating curve extrapolate . NULL, maximum stage value data selected upper bound. parallel logical value indicating whether run MCMC parallel . Defaults TRUE. num_cores integer 1 4 (number MCMC chains) indicating many cores use. used parallel=TRUE. NULL, number cores available device detected automatically. forcepoint logical vector length number rows data. element index \\(\\) TRUE indicates rating curve forced \\(\\)-th measurement. Use care, strongly influence resulting rating curve. verbose logical value indicating whether print progress diagnostic information. `TRUE`, function print messages runs. `FALSE`, function run silently. Default `TRUE`.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/plm0.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Power-law model with a constant variance — plm0","text":"plm0 returns object class \"plm0\". object class \"plm0\" list containing following components: rating_curve data frame 2.5%, 50% 97.5% percentiles posterior predictive distribution rating curve. rating_curve_mean data frame 2.5%, 50% 97.5% percentiles posterior distribution mean rating curve. param_summary data frame 2.5%, 50% 97.5% percentiles posterior distribution latent- hyperparameters. Additionally contains columns r_hat effective number samples parameter defined Gelman et al. (2013). posterior_log_likelihood_summary data frame 2.5%, 50% 97.5% percentiles posterior log-likelihood values. rating_curve_posterior matrix containing full thinned posterior samples posterior predictive distribution rating curve (excluding burn-). rating_curve_mean_posterior matrix containing full thinned posterior samples posterior distribution mean rating curve (excluding burn-). a_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\). b_posterior numeric vector containing full thinned posterior samples posterior distribution \\(b\\). c_posterior numeric vector containing full thinned posterior samples posterior distribution \\(c\\). sigma_eps_posterior numeric vector containing full thinned posterior samples posterior distribution \\(\\sigma_{\\varepsilon}\\). posterior_log_likelihood numeric vector containing full thinned posterior log-likelihood values, excluding burn-samples. D_hat statistic defined -2 times log-likelihood evaluated median value parameters. effective_num_param_DIC effective number parameters, calculated median(-2*posterior_log_likelihood) minus D_hat. DIC Deviance Information Criterion model, calculated D_hat plus 2*effective_num_parameters_DIC. lppd log pointwise predictive density observed data model WAIC Widely Applicable Information Criterion model, defined -2*( lppd - effective_num_param_WAIC ). WAIC_i pointwise WAIC values, WAIC := sum(WAIC_i). effective_num_param_WAIC effective number parameters, calculated summing posterior variance log predictive density data point. autocorrelation data frame autocorrelation parameter different lags. acceptance_rate proportion accepted samples thinned MCMC chain (excluding burn-). formula object type \"formula\" provided user. data data provided user, ordered stage. run_info information input arguments specific parameters used MCMC chain.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/plm0.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Power-law model with a constant variance — plm0","text":"power-law model, commonly used hydraulic practice, form $$Q=(h-c)^{b}$$ \\(Q\\) discharge, \\(h\\) stage \\(\\), \\(b\\) \\(c\\) unknown constants. power-law model inferred using Bayesian hierarchical model. model logarithmic scale $$\\log(Q_i) = \\log() + b \\log(h_i - c) + \\varepsilon,     = 1,...,n$$ \\(\\varepsilon\\) follows normal distribution mean zero variance \\(\\sigma_\\varepsilon^2\\), independent stage. efficient posterior simulation achieved sampling joint posterior density hyperparameters model, sampling density latent parameters conditional hyperparameters. Bayesian inference based posterior density summary statistics posterior mean 95% posterior intervals based posterior density. Analytical formulas summary statistics intractable cases thus computed generating samples posterior density using Markov chain Monte Carlo simulation.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/plm0.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Power-law model with a constant variance — plm0","text":"Gelman, ., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari, ., Rubin, D. B. (2013). Bayesian Data Analysis, Third Edition. Chapman & Hall/CRC Texts Statistical Science. Taylor & Francis. doi: https://doi.org/10.1201/b16018 Hrafnkelsson, B., Sigurdarson, H., Rögnvaldsson, S., Jansson, . Ö., Vias, R. D., Gardarsson, S. M. (2022). Generalization power-law rating curve using hydrodynamic theory Bayesian hierarchical modeling, Environmetrics, 33(2):e2711. doi: https://doi.org/10.1002/env.2711 Spiegelhalter, D., Best, N., Carlin, B., Van Der Linde, . (2002). Bayesian measures model complexity fit. Journal Royal Statistical Society: Series B (Statistical Methodology) 64(4), 583–639. doi: https://doi.org/10.1111/1467-9868.00353 Watanabe, S. (2010). Asymptotic equivalence Bayes cross validation widely applicable information criterion singular learning theory. J. Mach. Learn. Res. 11, 3571–3594.","code":""},{"path":[]},{"path":"https://sor16.github.io/bdrc/dev/reference/plm0.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Power-law model with a constant variance — plm0","text":"","code":"# \\donttest{ data(skogsliden) set.seed(1) plm0.fit <- plm0(formula=Q~W,data=skogsliden,num_cores=2) #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 37.00%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). summary(plm0.fit) #>  #> Formula:  #>  Q ~ W #> Latent parameters: #>   lower-2.5% median-50% upper-97.5% #> a 10.29      10.77      11.22       #> b  2.09       2.17       2.26       #>  #> Hyperparameters: #>           lower-2.5% median-50% upper-97.5% #> c         3.9042     3.9201     3.9341      #> sigma_eps 0.0455     0.0592     0.0805      #>  #> WAIC: -68.50725 # }"},{"path":"https://sor16.github.io/bdrc/dev/reference/plot.plm0.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot method for discharge rating curves — plot.plm0","title":"Plot method for discharge rating curves — plot.plm0","text":"Visualize discharge rating curve model objects","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/plot.plm0.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot method for discharge rating curves — plot.plm0","text":"","code":"# S3 method for class 'plm0' plot(   x,   ...,   type = \"rating_curve\",   param = NULL,   transformed = FALSE,   title = NULL,   xlim = NULL,   ylim = NULL )  # S3 method for class 'plm' plot(   x,   ...,   type = \"rating_curve\",   param = NULL,   transformed = FALSE,   title = NULL,   xlim = NULL,   ylim = NULL )  # S3 method for class 'gplm0' plot(   x,   ...,   type = \"rating_curve\",   param = NULL,   transformed = FALSE,   title = NULL,   xlim = NULL,   ylim = NULL )  # S3 method for class 'gplm' plot(   x,   ...,   type = \"rating_curve\",   param = NULL,   transformed = FALSE,   title = NULL,   xlim = NULL,   ylim = NULL )"},{"path":"https://sor16.github.io/bdrc/dev/reference/plot.plm0.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot method for discharge rating curves — plot.plm0","text":"x object class \"plm0\", \"plm\", \"gplm0\" \"gplm\". ... plotting parameters (used function) type character denoting type plot drawn. Defaults \"rating_curve\". Possible types \"rating_curve\" plot rating curve. \"rating_curve_mean\" plot posterior mean rating curve. \"f\" plot power-law exponent. \"beta\" plot random effect power-law exponent. \"sigma_eps\" plot standard deviation data level. \"residuals\" plot log residuals. \"trace\" plot trace plots parameters given param. \"histogram\" plot histograms parameters given param. \"panel\" plot 2x2 panel plots: \"rating curve\", \"residuals\", \"f\" \"sigma_eps\" param character vector parameters plot. Defaults NULL used type \"trace\" \"histogram\". Allowed values parameters given model summary x well \"hyperparameters\" \"latent_parameters\" specific groups parameters. transformed logical value indicating whether quantity plotted transformed scale used Bayesian inference. Defaults FALSE. title character denoting title plot xlim numeric vector length 2, denoting limits x axis plot. Applicable types \"rating_curve\",\"rating_curve_mean\",\"f\",\"beta\",\"sigma_eps\",\"residuals\". ylim numeric vector length 2, denoting limits y axis plot. Applicable types \"rating_curve\",\"rating_curve_mean\",\"f\",\"beta\",\"sigma_eps\",\"residuals\".","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/plot.plm0.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot method for discharge rating curves — plot.plm0","text":"return value, called side effects.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/plot.plm0.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Plot method for discharge rating curves — plot.plm0","text":"plot(plm0): Plot method plm0 plot(plm): Plot method plm plot(gplm0): Plot method gplm0 plot(gplm): Plot method gplm","code":""},{"path":[]},{"path":"https://sor16.github.io/bdrc/dev/reference/plot.plm0.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot method for discharge rating curves — plot.plm0","text":"","code":"# \\donttest{ data(krokfors) set.seed(1) plm0.fit <- plm0(formula=Q~W,data=krokfors,num_cores=2) #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 36.09%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400).  plot(plm0.fit)  plot(plm0.fit,transformed=TRUE)  plot(plm0.fit,type='histogram',param='c')  plot(plm0.fit,type='histogram',param='c',transformed=TRUE)  plot(plm0.fit,type='histogram',param='hyperparameters')  plot(plm0.fit,type='histogram',param='latent_parameters')  plot(plm0.fit,type='residuals')  plot(plm0.fit,type='f')  plot(plm0.fit,type='sigma_eps')  # }"},{"path":"https://sor16.github.io/bdrc/dev/reference/plot.tournament.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot method for discharge rating curve tournament — plot.tournament","title":"Plot method for discharge rating curve tournament — plot.tournament","text":"Compare four models tournament object multiple ways","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/plot.tournament.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot method for discharge rating curve tournament — plot.tournament","text":"","code":"# S3 method for class 'tournament' plot(x, ..., type = \"tournament_results\", transformed = FALSE)"},{"path":"https://sor16.github.io/bdrc/dev/reference/plot.tournament.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot method for discharge rating curve tournament — plot.tournament","text":"x object class \"tournament\" ... plotting parameters (used function) type character denoting type plot drawn. Possible types \"boxplot\" create boxplot posterior log-likelihood values, deviance scale. \"rating_curve\" plot rating curve. \"rating_curve_mean\" plot posterior mean rating curve. \"f\" plot power-law exponent. \"sigma_eps\" plot standard deviation data level. \"residuals\" plot log residuals. \"tournament_results\" plot tournament results visually, game game. transformed logical value indicating whether quantity plotted transformed scale used Bayesian inference. Defaults FALSE.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/plot.tournament.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot method for discharge rating curve tournament — plot.tournament","text":"return value, called side effects","code":""},{"path":[]},{"path":"https://sor16.github.io/bdrc/dev/reference/plot.tournament.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot method for discharge rating curve tournament — plot.tournament","text":"","code":"# \\donttest{ data(krokfors) set.seed(1) t_obj <- tournament(formula=Q~W,data=krokfors,num_cores=2) #> Running tournament [                                                ] 0% #>  #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 25.33%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). #>  #> - gplm finished  [============                                    ] 25% #>  #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 31.14%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). #>  #> - gplm0 finished [========================                        ] 50% #>  #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 25.66%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). #>  #> - plm finished   [====================================            ] 75% #>  #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 36.04%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). #>  #> - plm0 finished  [================================================] 100% #>  #> Tournament winner: gplm0 plot(t_obj) plot(t_obj,transformed=TRUE)  plot(t_obj,type='boxplot') plot(t_obj,type='f') plot(t_obj,type='sigma_eps') plot(t_obj,type='residuals') plot(t_obj,type='tournament_results')  # }"},{"path":"https://sor16.github.io/bdrc/dev/reference/plot_fun.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot bdrc model objects — plot_fun","title":"Plot bdrc model objects — plot_fun","text":"Visualize results model objects bdrc, plm0, plm, gplm0,gplm","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/plot_fun.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot bdrc model objects — plot_fun","text":"","code":"plot_fun(   x,   type = \"rating_curve\",   param = NULL,   transformed = FALSE,   title = NULL,   xlim = NULL,   ylim = NULL,   ... )"},{"path":"https://sor16.github.io/bdrc/dev/reference/plot_fun.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot bdrc model objects — plot_fun","text":"x object class \"plm0\",\"plm\",\"gplm0\" \"gplm\". type character denoting type plot drawn. Defaults \"rating_curve\". Possible types \"rating_curve\" plot rating curve. \"rating_curve_mean\" plot posterior mean rating curve. \"f\" plot power-law exponent. \"beta\" plot random effect power-law exponent. \"sigma_eps\" plot standard deviation data level. \"residuals\" plot log residuals. \"trace\" plot trace plots parameters given param. \"histogram\" plot histograms parameters given param. \"panel\" plot 2x2 panel plots: \"rating curve\", \"residuals\", \"f\" \"sigma_eps\" param character vector parameters plot. Defaults NULL used type \"trace\" \"histogram\". Allowed values parameters given model summary x well \"hyperparameters\" \"latent_parameters\" specific groups parameters. transformed logical value indicating whether quantity plotted transformed scale used Bayesian inference. Defaults FALSE. title character denoting title plot. Defaults NULL, .e. title. xlim numeric vector length 2, denoting limits x axis plot. Applicable types \"rating_curve\",\"rating_curve_mean\",\"f\",\"beta\",\"sigma_eps\",\"residuals\". ylim numeric vector length 2, denoting limits y axis plot. Applicable types \"rating_curve\",\"rating_curve_mean\",\"f\",\"beta\",\"sigma_eps\",\"residuals\".","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/plot_fun.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot bdrc model objects — plot_fun","text":"returns object class ggplot2.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/predict.plm0.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict method for discharge rating curves — predict.plm0","title":"Predict method for discharge rating curves — predict.plm0","text":"Predict discharge given stage values based discharge rating curve model object.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/predict.plm0.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict method for discharge rating curves — predict.plm0","text":"","code":"# S3 method for class 'plm0' predict(object, ..., newdata = NULL, wide = FALSE)  # S3 method for class 'plm' predict(object, ..., newdata = NULL, wide = FALSE)  # S3 method for class 'gplm0' predict(object, ..., newdata = NULL, wide = FALSE)  # S3 method for class 'gplm' predict(object, ..., newdata = NULL, wide = FALSE)"},{"path":"https://sor16.github.io/bdrc/dev/reference/predict.plm0.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict method for discharge rating curves — predict.plm0","text":"object object class \"plm0\", \"plm\", \"gplm0\" \"gplm\". ... used function newdata numeric vector stage values predict. omitted, stage values data used. wide logical value denoting whether produce wide prediction output.TRUE, output table median prediction values equally spaced grid stages 1 cm increments, row containing predictions decimeter range stages.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/predict.plm0.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict method for discharge rating curves — predict.plm0","text":"object class \"data.frame\" four columns, h (stage), lower (2.5% posterior predictive quantile), median (50% posterior predictive quantile), upper (97.5% posterior predictive quantile). wide=TRUE, matrix described (see wide parameter) returned.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/predict.plm0.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Predict method for discharge rating curves — predict.plm0","text":"predict(plm0): Predict method plm0 predict(plm): Predict method plm predict(gplm0): Predict method gplm0 predict(gplm): Predict method gplm","code":""},{"path":[]},{"path":"https://sor16.github.io/bdrc/dev/reference/predict.plm0.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predict method for discharge rating curves — predict.plm0","text":"","code":"# \\donttest{ data(krokfors) set.seed(1) plm0.fit <- plm0(formula=Q~W,data=krokfors,h_max=10,num_cores=2) #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 36.22%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). #predict rating curve on a equally 10 cm spaced grid from 9 to 10 meters predict(plm0.fit,newdata=seq(9,10,by=0.1)) #>       h     lower    median     upper #> 1   9.0  2.423761  3.617127  5.355104 #> 2   9.1  2.988084  4.448245  6.528722 #> 3   9.2  3.616549  5.374700  7.940233 #> 4   9.3  4.291666  6.418404  9.515431 #> 5   9.4  5.056743  7.601828 11.323903 #> 6   9.5  5.914344  8.919305 13.169163 #> 7   9.6  6.893257 10.380845 15.570683 #> 8   9.7  7.860588 11.974804 17.826516 #> 9   9.8  9.052186 13.709759 20.592950 #> 10  9.9 10.158058 15.660659 23.351463 #> 11 10.0 11.489777 17.692248 26.874426 # }"},{"path":"https://sor16.github.io/bdrc/dev/reference/print.plm0.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for discharge rating curves — print.plm0","title":"Print method for discharge rating curves — print.plm0","text":"Print discharge rating curve model object","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/print.plm0.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for discharge rating curves — print.plm0","text":"","code":"# S3 method for class 'plm0' print(x, ...)  # S3 method for class 'plm' print(x, ...)  # S3 method for class 'gplm0' print(x, ...)  # S3 method for class 'gplm' print(x, ...)"},{"path":"https://sor16.github.io/bdrc/dev/reference/print.plm0.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for discharge rating curves — print.plm0","text":"x object class \"plm0\", \"plm\", \"gplm0\" \"gplm\". ... used function","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/print.plm0.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Print method for discharge rating curves — print.plm0","text":"print(plm0): Print method plm0 print(plm): Print method plm print(gplm0): Print method gplm0 print(gplm): Print method gplm","code":""},{"path":[]},{"path":"https://sor16.github.io/bdrc/dev/reference/print.tournament.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for discharge rating curve tournament — print.tournament","title":"Print method for discharge rating curve tournament — print.tournament","text":"Print results tournament discharge rating curve model comparisons","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/print.tournament.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for discharge rating curve tournament — print.tournament","text":"","code":"# S3 method for class 'tournament' print(x, ...)"},{"path":"https://sor16.github.io/bdrc/dev/reference/print.tournament.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for discharge rating curve tournament — print.tournament","text":"x object class \"tournament\" ... used function","code":""},{"path":[]},{"path":"https://sor16.github.io/bdrc/dev/reference/skjalf.html","id":null,"dir":"Reference","previous_headings":"","what":"Skjalfandafljot gauging station in Iceland — skjalf","title":"Skjalfandafljot gauging station in Iceland — skjalf","text":"Data discharge stage Skjalfandafljot gauging station Iceland","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/skjalf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Skjalfandafljot gauging station in Iceland — skjalf","text":"","code":"skjalf"},{"path":"https://sor16.github.io/bdrc/dev/reference/skjalf.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Skjalfandafljot gauging station in Iceland — skjalf","text":"data frame columns: W Measurements water stage meters Q Measurements water discharge cubic meters per second","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/skjalf.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Skjalfandafljot gauging station in Iceland — skjalf","text":"Icelandic Meteorological Office, Landsvirkjun - National Power Company Iceland, Icelandic Road Coastal Administration.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/skogsliden.html","id":null,"dir":"Reference","previous_headings":"","what":"Skogsliden gauging station in Sweden — skogsliden","title":"Skogsliden gauging station in Sweden — skogsliden","text":"Data discharge stage Skogsliden gauging station Sweden","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/skogsliden.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Skogsliden gauging station in Sweden — skogsliden","text":"","code":"skogsliden"},{"path":"https://sor16.github.io/bdrc/dev/reference/skogsliden.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Skogsliden gauging station in Sweden — skogsliden","text":"data frame columns: W Measurements water stage meters Q Measurements water discharge cubic meters per second","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/skogsliden.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Skogsliden gauging station in Sweden — skogsliden","text":"Swedish Meteorological Hydrological Institute.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/spanga.html","id":null,"dir":"Reference","previous_headings":"","what":"Spanga gauging station in Sweden — spanga","title":"Spanga gauging station in Sweden — spanga","text":"Data discharge stage Spanga gauging station Sweden.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/spanga.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Spanga gauging station in Sweden — spanga","text":"","code":"spanga"},{"path":"https://sor16.github.io/bdrc/dev/reference/spanga.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Spanga gauging station in Sweden — spanga","text":"data frame columns: W Measurements water stage meters Q Measurements water discharge cubic meters per second","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/spanga.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Spanga gauging station in Sweden — spanga","text":"Swedish Meteorological Hydrological Institute.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/spread_draws.html","id":null,"dir":"Reference","previous_headings":"","what":"Spread MCMC chain draws to data.frame on a wide format — spread_draws","title":"Spread MCMC chain draws to data.frame on a wide format — spread_draws","text":"Useful convert MCMC chain draws particular parameters output model object wide format data wrangling","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/spread_draws.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Spread MCMC chain draws to data.frame on a wide format — spread_draws","text":"","code":"spread_draws(mod, ..., transformed = FALSE)"},{"path":"https://sor16.github.io/bdrc/dev/reference/spread_draws.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Spread MCMC chain draws to data.frame on a wide format — spread_draws","text":"mod object class \"plm0\",\"plm\",\"gplm0\" \"gplm\". ... number character vectors containing valid names parameters model \"rating_curve\" \"rating_curve_mean\". Also accepts \"latent_parameters\" \"hyperparameters\". transformed boolean value determining whether output represented transformed scale used sampling MCMC chain original scale. Defaults FALSE.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/spread_draws.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Spread MCMC chain draws to data.frame on a wide format — spread_draws","text":"Data frame columns chain iter param value","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/spread_draws.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Spread MCMC chain draws to data.frame on a wide format — spread_draws","text":"Hrafnkelsson, B., Sigurdarson, H., Rögnvaldsson, S., Jansson, . Ö., Vias, R. D., Gardarsson, S. M. (2022). Generalization power-law rating curve using hydrodynamic theory Bayesian hierarchical modeling, Environmetrics, 33(2):e2711. doi: https://doi.org/10.1002/env.2711","code":""},{"path":[]},{"path":"https://sor16.github.io/bdrc/dev/reference/spread_draws.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Spread MCMC chain draws to data.frame on a wide format — spread_draws","text":"","code":"# \\donttest{ data(krokfors) set.seed(1) plm0.fit <- plm0(formula=Q~W,data=krokfors,num_cores=2) #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 36.09%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). hyp_samples <- spread_draws(plm0.fit,'hyperparameters') head(hyp_samples) #>   chain iter        c sigma_eps #> 1     1    1 7.693275 0.2421924 #> 2     1    2 7.708797 0.2256351 #> 3     1    3 7.704167 0.1679654 #> 4     1    4 7.666575 0.1807933 #> 5     1    5 7.658464 0.1570101 #> 6     1    6 7.709366 0.1968574 rating_curve_samples <- spread_draws(plm0.fit,'rating_curve','rating_curve_mean') head(rating_curve_samples) #>   chain iter        h rating_curve rating_curve_mean #> 1     1    1 7.673811 0.000000e+00      0.000000e+00 #> 2     1    2 7.673811 0.000000e+00      0.000000e+00 #> 3     1    3 7.673811 0.000000e+00      0.000000e+00 #> 4     1    4 7.673811 1.094840e-06      1.018866e-06 #> 5     1    5 7.673811 6.537613e-06      6.335393e-06 #> 6     1    6 7.673811 0.000000e+00      0.000000e+00 # }"},{"path":"https://sor16.github.io/bdrc/dev/reference/summary.plm0.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for discharge rating curves — summary.plm0","title":"Summary method for discharge rating curves — summary.plm0","text":"Summarize discharge rating curve model object","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/summary.plm0.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for discharge rating curves — summary.plm0","text":"","code":"# S3 method for class 'plm0' summary(object, ...)  # S3 method for class 'plm' summary(object, ...)  # S3 method for class 'gplm0' summary(object, ...)  # S3 method for class 'gplm' summary(object, ...)"},{"path":"https://sor16.github.io/bdrc/dev/reference/summary.plm0.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for discharge rating curves — summary.plm0","text":"object object class \"plm0\", \"plm\", \"gplm0\" \"gplm\". ... used function","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/summary.plm0.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Summary method for discharge rating curves — summary.plm0","text":"summary(plm0): Summary method plm0 summary(plm): Summary method plm summary(gplm0): Summary method gplm0 summary(gplm): Summary method gplm","code":""},{"path":[]},{"path":"https://sor16.github.io/bdrc/dev/reference/summary.plm0.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary method for discharge rating curves — summary.plm0","text":"","code":"# \\donttest{ data(krokfors) set.seed(1) plm0.fit <- plm0(formula=Q~W,data=krokfors,num_cores=2) #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 36.09%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). summary(plm0.fit) #>  #> Formula:  #>  Q ~ W #> Latent parameters: #>   lower-2.5% median-50% upper-97.5% #> a 1.15       1.64       2.12        #> b 2.46       2.82       3.21        #>  #> Hyperparameters: #>           lower-2.5% median-50% upper-97.5% #> c         7.580      7.676      7.752       #> sigma_eps 0.151      0.191      0.253       #>  #> WAIC: -2.864097 # }"},{"path":"https://sor16.github.io/bdrc/dev/reference/summary.tournament.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for a discharge rating curve tournament — summary.tournament","title":"Summary method for a discharge rating curve tournament — summary.tournament","text":"Print summary tournament model comparisons","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/summary.tournament.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for a discharge rating curve tournament — summary.tournament","text":"","code":"# S3 method for class 'tournament' summary(object, ...)"},{"path":"https://sor16.github.io/bdrc/dev/reference/summary.tournament.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for a discharge rating curve tournament — summary.tournament","text":"object object class \"tournament\" ... used function","code":""},{"path":[]},{"path":"https://sor16.github.io/bdrc/dev/reference/summary.tournament.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary method for a discharge rating curve tournament — summary.tournament","text":"","code":"# \\donttest{ data(krokfors) set.seed(1) t_obj <- tournament(Q~W,krokfors,num_cores=2) #> Running tournament [                                                ] 0% #>  #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 25.33%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). #>  #> - gplm finished  [============                                    ] 25% #>  #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 31.14%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). #>  #> - gplm0 finished [========================                        ] 50% #>  #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 25.66%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). #>  #> - plm finished   [====================================            ] 75% #>  #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 36.04%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). #>  #> - plm0 finished  [================================================] 100% #>  #> Tournament winner: gplm0 summary(t_obj) #>   round game model      lppd eff_num_param       WAIC Delta_WAIC winner #> 1     1    1  gplm 20.779382      6.870566 -27.817631  0.5570133  FALSE #> 2     1    1 gplm0 20.370954      6.740645 -27.260617         NA   TRUE #> 3     1    2   plm  5.584163      4.257375  -2.653577 -0.4065514  FALSE #> 4     1    2  plm0  5.628423      4.098359  -3.060129         NA   TRUE #> 5     2    3 gplm0 20.370954      6.740645 -27.260617 24.2004887   TRUE #> 6     2    3  plm0  5.628423      4.098359  -3.060129         NA  FALSE # }"},{"path":"https://sor16.github.io/bdrc/dev/reference/theme_bdrc.html","id":null,"dir":"Reference","previous_headings":"","what":"Custom bdrc theme — theme_bdrc","title":"Custom bdrc theme — theme_bdrc","text":"Custom bdrc theme","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/theme_bdrc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Custom bdrc theme — theme_bdrc","text":"","code":"theme_bdrc(..., scaling = 1)"},{"path":"https://sor16.github.io/bdrc/dev/reference/theme_bdrc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Custom bdrc theme — theme_bdrc","text":"... used function scaling numerical value can used scale size text titles plot uses theme_bdrc. Defaults 1.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/theme_bdrc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Custom bdrc theme — theme_bdrc","text":"returns theme object package","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/tournament.html","id":null,"dir":"Reference","previous_headings":"","what":"Tournament - Model comparison — tournament","title":"Tournament - Model comparison — tournament","text":"tournament compares four rating curve models different complexities determines model provides best fit data hand.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/tournament.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tournament - Model comparison — tournament","text":"","code":"tournament(   formula = NULL,   data = NULL,   model_list = NULL,   method = \"WAIC\",   winning_criteria = NULL,   verbose = TRUE,   ... )"},{"path":"https://sor16.github.io/bdrc/dev/reference/tournament.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tournament - Model comparison — tournament","text":"formula object class \"formula\", discharge column name response stage column name covariate. data data.frame containing variables specified formula. model_list list exactly four model objects types \"plm0\",\"plm\",\"gplm0\" \"gplm\" used tournament. Note model objects required run data c_param. method string specifying method used estimate predictive performance models. allowed methods \"WAIC\", \"DIC\" \"PMP\". winning_criteria numerical value sets threshold complex model model comparison must exceed deemed appropriate model. See Details section. verbose logical value indicating whether print progress diagnostic information. `TRUE`, function print messages runs. `FALSE`, function run silently. Default `TRUE`. ... Optional arguments passed model functions.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/tournament.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tournament - Model comparison — tournament","text":"object type \"tournament\" following elements contestants model objects types \"plm0\",\"plm\",\"gplm0\" \"gplm\" compared. winner model object tournament winner. summary data frame information results different games tournament. info specifics tournament; overall winner; method used; winning criteria.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/tournament.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Tournament - Model comparison — tournament","text":"Tournament model comparison method uses WAIC (default method) estimate expected prediction error four models select appropriate model given data. first round model comparisons sets two games model types, \"gplm\" vs. \"gplm0\" \"plm\" vs. \"plm0\". two comparisons conducted WAIC complex model (\"gplm\" \"plm\", respectively) smaller WAIC simpler models (\"gplm0\" \"plm0\", respectively) input argument called winning_criteria (default value = 2), chosen appropriate model. , simpler model chosen. appropriate models move second round compared way. winner second round chosen overall tournament winner deemed appropriate model given data. default method \"WAIC\", Widely Applicable Information Criterion (see Watanabe (2010)), used estimate predictive performance models. method fully Bayesian method uses full set posterior draws estimate expected log pointwise predictive density. Method \"DIC\", Deviance Information Criterion (see Spiegelhalter (2002)), similar \"WAIC\" instead using full set posterior draws compute estimate expected log pointwise predictive density, uses point estimate posterior distribution. Method \"PMP\" uses posterior model probabilities, calculated Bayes factor (see Jeffreys (1961) Kass Raftery (1995)), compare models, models assumed priori equally likely. method chosen default method Bayes factor calculations can quite unstable. methods \"WAIC\" \"DIC\" used, winning_criteria real number. winning criteria threshold value complex model model comparison must exceed declared appropriate model. Setting winning criteria slightly 0 (default value = 2 \"WAIC\" \"DIC\") gives less complex model comparison slight advantage. method \"PMP\" used, winning criteria real value 0 1 (default value = 0.75). sets threshold value posterior probability complex model, given data, model comparison must exceed declared appropriate model. three cases, default value selected give less complex models slight advantage, give less consistent results applying tournament real world data.","code":""},{"path":"https://sor16.github.io/bdrc/dev/reference/tournament.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Tournament - Model comparison — tournament","text":"Hrafnkelsson, B., Sigurdarson, H., Rögnvaldsson, S., Jansson, . Ö., Vias, R. D., Gardarsson, S. M. (2022). Generalization power-law rating curve using hydrodynamic theory Bayesian hierarchical modeling, Environmetrics, 33(2):e2711. doi: https://doi.org/10.1002/env.2711 Jeffreys, H. (1961). Theory Probability, Third Edition. Oxford University Press. Kass, R., . Raftery, . (1995). Bayes Factors. Journal American Statistical Association, 90, 773-795. doi: https://doi.org/10.1080/01621459.1995.10476572 Spiegelhalter, D., Best, N., Carlin, B., Van Der Linde, . (2002). Bayesian measures model complexity fit. Journal Royal Statistical Society: Series B (Statistical Methodology) 64(4), 583–639. doi: https://doi.org/10.1111/1467-9868.00353 Watanabe, S. (2010). Asymptotic equivalence Bayes cross validation widely applicable information criterion singular learning theory. J. Mach. Learn. Res. 11, 3571–3594.","code":""},{"path":[]},{"path":"https://sor16.github.io/bdrc/dev/reference/tournament.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Tournament - Model comparison — tournament","text":"","code":"# \\donttest{ data(krokfors) set.seed(1) t_obj <- tournament(formula=Q~W,data=krokfors,num_cores=2) #> Running tournament [                                                ] 0% #>  #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 25.33%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). #>  #> - gplm finished  [============                                    ] 25% #>  #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 31.14%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). #>  #> - gplm0 finished [========================                        ] 50% #>  #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 25.66%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). #>  #> - plm finished   [====================================            ] 75% #>  #> Progress: #> Initializing Metropolis MCMC algorithm... #> Multiprocess sampling (4 chains in 2 jobs) ... #>  #> MCMC sampling completed! #>  #> Diagnostics: #> Acceptance rate: 36.04%. #> ✔ All chains have mixed well (Rhat < 1.1). #> ✔ Effective sample sizes sufficient (eff_n_samples > 400). #>  #> - plm0 finished  [================================================] 100% #>  #> Tournament winner: gplm0 t_obj #> Tournament winner: gplm0 summary(t_obj) #>   round game model      lppd eff_num_param       WAIC Delta_WAIC winner #> 1     1    1  gplm 20.779382      6.870566 -27.817631  0.5570133  FALSE #> 2     1    1 gplm0 20.370954      6.740645 -27.260617         NA   TRUE #> 3     1    2   plm  5.584163      4.257375  -2.653577 -0.4065514  FALSE #> 4     1    2  plm0  5.628423      4.098359  -3.060129         NA   TRUE #> 5     2    3 gplm0 20.370954      6.740645 -27.260617 24.2004887   TRUE #> 6     2    3  plm0  5.628423      4.098359  -3.060129         NA  FALSE # }"},{"path":[]},{"path":"https://sor16.github.io/bdrc/dev/news/index.html","id":"bdrc-110","dir":"Changelog","previous_headings":"","what":"bdrc 1.1.0","title":"bdrc 1.1.0","text":"CRAN release: 2023-03-19 tournament function now supports information criteria (WAIC & DIC) model selection criteria, WAIC new default. Six new real-world datasets Iceland Sweden containing paired observations stage discharge included package. package can now also used user-friendly interactive rating curve builder Shiny application [https://bdrc.shinyapps.io/bdrc/].","code":""},{"path":"https://sor16.github.io/bdrc/dev/news/index.html","id":"bdrc-100","dir":"Changelog","previous_headings":"","what":"bdrc 1.0.0","title":"bdrc 1.0.0","text":"CRAN release: 2021-07-28 Release first version package.","code":""}]
