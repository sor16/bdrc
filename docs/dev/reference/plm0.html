<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Power-law model with a constant variance — plm0 • bdrc</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Power-law model with a constant variance — plm0"><meta name="description" content='plm0 is used to fit a discharge rating curve for paired measurements of stage and discharge using a power-law model with a constant variance as described in Hrafnkelsson et al. (2022). See "Details" for a more elaborate description of the model.'><meta property="og:description" content='plm0 is used to fit a discharge rating curve for paired measurements of stage and discharge using a power-law model with a constant variance as described in Hrafnkelsson et al. (2022). See "Details" for a more elaborate description of the model.'><meta property="og:image" content="https://sor16.github.io/bdrc/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bdrc</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/background.html">Background</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">Introduction to bdrc</a></li>
    <li><a class="dropdown-item" href="../articles/tournament.html">Tournament - Model Comparison</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sor16/bdrc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Power-law model with a constant variance</h1>
      <small class="dont-index">Source: <a href="https://github.com/sor16/bdrc/blob/HEAD/R/plm0.R" class="external-link"><code>R/plm0.R</code></a></small>
      <div class="d-none name"><code>plm0.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>plm0 is used to fit a discharge rating curve for paired measurements of stage and discharge using a power-law model with a constant variance as described in Hrafnkelsson et al. (2022). See "Details" for a more elaborate description of the model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plm0</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  c_param <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  h_max <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  num_cores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  forcepoint <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>An object of class "formula", with discharge column name as response and stage column name as a covariate, i.e. of the form <code>y</code>~<code>x</code> where <code>y</code> is discharge in m\(^3/\)s and <code>x</code> is stage in m (it is very important that the data is in the correct units).</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data.frame containing the variables specified in formula.</p></dd>


<dt id="arg-c-param">c_param<a class="anchor" aria-label="anchor" href="#arg-c-param"></a></dt>
<dd><p>The largest stage value for which there is zero discharge. If NULL, it is treated as unknown in the model and inferred from the data.</p></dd>


<dt id="arg-h-max">h_max<a class="anchor" aria-label="anchor" href="#arg-h-max"></a></dt>
<dd><p>The maximum stage to which the rating curve should extrapolate to. If NULL, the maximum stage value in the data is selected as an upper bound.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>A logical value indicating whether to run the MCMC in parallel or not. Defaults to TRUE.</p></dd>


<dt id="arg-num-cores">num_cores<a class="anchor" aria-label="anchor" href="#arg-num-cores"></a></dt>
<dd><p>An integer between 1 and 4 (number of MCMC chains) indicating how many cores to use. Only used if parallel=TRUE. If NULL, the number of cores available on the device is detected automatically.</p></dd>


<dt id="arg-forcepoint">forcepoint<a class="anchor" aria-label="anchor" href="#arg-forcepoint"></a></dt>
<dd><p>A logical vector of the same length as the number of rows in data. If an element at index \(i\) is TRUE it indicates that the rating curve should be forced through the \(i\)-th measurement. Use with care, as this will strongly influence the resulting rating curve.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A logical value indicating whether to print progress and diagnostic information. If `TRUE`, the function will print messages as it runs. If `FALSE`, the function will run silently. Default is `TRUE`.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>plm0 returns an object of class "plm0". An object of class "plm0" is a list containing the following components: <br></p>
<dl><dt><code>rating_curve</code></dt>
<dd><p>a data frame with 2.5%, 50% and 97.5% percentiles of the posterior predictive distribution of the rating curve.</p></dd>

<dt><code>rating_curve_mean</code></dt>
<dd><p>a data frame with 2.5%, 50% and 97.5% percentiles of the posterior distribution of the mean of the rating curve.</p></dd>

<dt><code>param_summary</code></dt>
<dd><p>a data frame with 2.5%, 50% and 97.5% percentiles of the posterior distribution of latent- and hyperparameters. Additionally contains columns with r_hat and the effective number of samples for each parameter as defined in Gelman et al. (2013).</p></dd>

<dt><code>posterior_log_likelihood_summary</code></dt>
<dd><p>a data frame with 2.5%, 50% and 97.5% percentiles of the posterior log-likelihood values.</p></dd>

<dt><code>rating_curve_posterior</code></dt>
<dd><p>a matrix containing the full thinned posterior samples of the posterior predictive distribution of the rating curve (excluding burn-in).</p></dd>

<dt><code>rating_curve_mean_posterior</code></dt>
<dd><p>a matrix containing the full thinned posterior samples of the posterior distribution of the mean of the rating curve (excluding burn-in).</p></dd>

<dt><code>a_posterior</code></dt>
<dd><p>a numeric vector containing the full thinned posterior samples of the posterior distribution of \(a\).</p></dd>

<dt><code>b_posterior</code></dt>
<dd><p>a numeric vector containing the full thinned posterior samples of the posterior distribution of \(b\).</p></dd>

<dt><code>c_posterior</code></dt>
<dd><p>a numeric vector containing the full thinned posterior samples of the posterior distribution of \(c\).</p></dd>

<dt><code>sigma_eps_posterior</code></dt>
<dd><p>a numeric vector containing the full thinned posterior samples of the posterior distribution of \(\sigma_{\varepsilon}\).</p></dd>

<dt><code>posterior_log_likelihood</code></dt>
<dd><p>a numeric vector containing the full thinned posterior log-likelihood values, excluding burn-in samples.</p></dd>

<dt><code>D_hat</code></dt>
<dd><p>statistic defined as -2 times the log-likelihood evaluated at the median value of the parameters.</p></dd>

<dt><code>effective_num_param_DIC</code></dt>
<dd><p>effective number of parameters, which is calculated as median(-2*posterior_log_likelihood) minus D_hat.</p></dd>

<dt><code>DIC</code></dt>
<dd><p>Deviance Information Criterion for the model, calculated as D_hat plus 2*effective_num_parameters_DIC.</p></dd>

<dt><code>lppd</code></dt>
<dd><p>log pointwise predictive density of the observed data under the model</p></dd>

<dt><code>WAIC</code></dt>
<dd><p>Widely Applicable Information Criterion for the model, defined as -2*( lppd - effective_num_param_WAIC ).</p></dd>

<dt><code>WAIC_i</code></dt>
<dd><p>The pointwise WAIC values, where WAIC := sum(WAIC_i).</p></dd>

<dt><code>effective_num_param_WAIC</code></dt>
<dd><p>effective number of parameters, which is calculated by summing up the posterior variance of the log predictive density for each data point.</p></dd>

<dt><code>autocorrelation</code></dt>
<dd><p>a data frame with the autocorrelation of each parameter for different lags.</p></dd>

<dt><code>acceptance_rate</code></dt>
<dd><p>proportion of accepted samples in the thinned MCMC chain (excluding burn-in).</p></dd>

<dt><code>formula</code></dt>
<dd><p>object of type "formula" provided by the user.</p></dd>

<dt><code>data</code></dt>
<dd><p>data provided by the user, ordered by stage.</p></dd>

<dt><code>run_info</code></dt>
<dd><p>information about the input arguments and the specific parameters used in the MCMC chain.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The power-law model, which is commonly used in hydraulic practice, is of the form
$$Q=a(h-c)^{b}$$
where \(Q\) is discharge, \(h\) is stage and \(a\), \(b\) and \(c\) are unknown constants.<br><br>
The power-law model is here inferred by using a Bayesian hierarchical model. The model is on a logarithmic scale
$$\log(Q_i) = \log(a) + b \log(h_i - c) + \varepsilon,     i = 1,...,n$$
where \(\varepsilon\) follows a normal distribution with mean zero and variance \(\sigma_\varepsilon^2\), independent of stage. An efficient posterior simulation is achieved by sampling from the joint posterior density of the hyperparameters of the model, and then sampling from the density of the latent parameters conditional on the hyperparameters.<br><br>
Bayesian inference is based on the posterior density and summary statistics such as the posterior mean and 95% posterior intervals are based on the posterior density. Analytical formulas for these summary statistics are intractable in most cases and thus they are computed by generating samples from the posterior density using a Markov chain Monte Carlo simulation.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Gelman, A., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari, A., and Rubin, D. B. (2013). Bayesian Data Analysis, Third Edition. Chapman &amp; Hall/CRC Texts in Statistical Science. Taylor &amp; Francis. doi: https://doi.org/10.1201/b16018</p>
<p>Hrafnkelsson, B., Sigurdarson, H., Rögnvaldsson, S., Jansson, A. Ö., Vias, R. D., and Gardarsson, S. M. (2022). Generalization of the power-law rating curve using hydrodynamic theory and Bayesian hierarchical modeling, Environmetrics, 33(2):e2711. doi: https://doi.org/10.1002/env.2711</p>
<p>Spiegelhalter, D., Best, N., Carlin, B., Van Der Linde, A. (2002). Bayesian measures of model complexity and fit. Journal of the Royal Statistical Society: Series B (Statistical Methodology) 64(4), 583–639. doi: https://doi.org/10.1111/1467-9868.00353</p>
<p>Watanabe, S. (2010). Asymptotic equivalence of Bayes cross validation and widely applicable information criterion in singular learning theory. J. Mach. Learn. Res. 11, 3571–3594.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="summary.plm0.html">summary.plm0</a></code> for summaries, <code><a href="predict.plm0.html">predict.plm0</a></code> for prediction. It is also useful to look at <code><a href="spread_draws.html">spread_draws</a></code> and <code><a href="plot.plm0.html">plot.plm0</a></code> to help visualize the full posterior distributions.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">skogsliden</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">plm0.fit</span> <span class="op">&lt;-</span> <span class="fu">plm0</span><span class="op">(</span>formula<span class="op">=</span><span class="va">Q</span><span class="op">~</span><span class="va">W</span>,data<span class="op">=</span><span class="va">skogsliden</span>,num_cores<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Progress:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initializing Metropolis MCMC algorithm...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiprocess sampling (4 chains in 2 jobs) ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MCMC sampling completed!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Diagnostics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Acceptance rate: 37.00%.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ✔ All chains have mixed well (Rhat &lt; 1.1).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ✔ Effective sample sizes sufficient (eff_n_samples &gt; 400).</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">plm0.fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Q ~ W</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Latent parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   lower-2.5% median-50% upper-97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a 10.29      10.77      11.22      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b  2.09       2.17       2.26      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hyperparameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           lower-2.5% median-50% upper-97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c         3.9042     3.9201     3.9341     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma_eps 0.0455     0.0592     0.0805     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WAIC: -68.50725</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://english.hi.is/staff/birgirhr" class="external-link">Birgir Hrafnkelsson</a>, <a href="https://github.com/sor16" class="external-link">Solvi Rognvaldsson</a>, <a href="https://github.com/axelornj" class="external-link">Axel Orn Jansson</a>, Rafael Daníel Vias.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

